import { lazyAddEventListener } from "../controllers/LazyEvents";
//
const collectProviders = (ev, action) => {
    const providers = new Set();
    let el = ev?.target || document.activeElement || document.body;
    // Ignore if target is a native input that handles clipboard (unless we want to override?)
    if (el instanceof HTMLInputElement || el instanceof HTMLTextAreaElement || el.isContentEditable) {
        return [];
    }
    // 1. Walk up the tree (bubbling emulation / focus context)
    let current = el;
    while (current) {
        // Check if element instance has the methods (e.g. web components or custom objects attached)
        if (typeof current[action] === "function") {
            providers.add(current);
        }
        // Also check if there's an operative instance or controller attached
        if (current.operativeInstance && typeof current.operativeInstance[action] === "function") {
            providers.add(current.operativeInstance);
        }
        // Move up
        if (current.shadowRoot && current.shadowRoot.host) {
            current = current.shadowRoot.host;
        }
        else {
            current = (current.parentElement || current.getRootNode()?.host);
        }
    }
    // 2. TreeWalker Search (fallback: find any active provider in the composed tree)
    // This is useful if the focus is on body/document but a provider is conceptually active or visible
    if (ev.currentTarget instanceof Node || typeof document !== "undefined") {
        const root = (ev.currentTarget instanceof Node ? (ev.currentTarget instanceof Document ? ev.currentTarget.body : ev.currentTarget) : document.body);
        if (root) {
            const walker = document.createTreeWalker(root, NodeFilter.SHOW_ELEMENT, {
                acceptNode(node) {
                    if (typeof node[action] === "function" ||
                        (node.operativeInstance && typeof node.operativeInstance[action] === "function")) {
                        return NodeFilter.FILTER_ACCEPT;
                    }
                    return NodeFilter.FILTER_SKIP;
                }
            });
            while (walker.nextNode()) {
                const node = walker.currentNode;
                if (typeof node[action] === "function") {
                    providers.add(node);
                }
                if (node.operativeInstance && typeof node.operativeInstance[action] === "function") {
                    providers.add(node.operativeInstance);
                }
            }
        }
    }
    return Array.from(providers);
};
//
const handleClipboardEvent = (ev, type) => {
    const providers = collectProviders(ev, type);
    for (const provider of providers) {
        provider[type]?.(ev);
    }
};
//
let initialized = false;
export const initGlobalClipboard = () => {
    if (typeof window === "undefined" || initialized)
        return;
    initialized = true;
    // Lazily attach (single shared listener per event type) on first init.
    lazyAddEventListener(window, "copy", (ev) => handleClipboardEvent(ev, "onCopy"), { capture: false, passive: true });
    lazyAddEventListener(window, "cut", (ev) => handleClipboardEvent(ev, "onCut"), { capture: false, passive: true });
    lazyAddEventListener(window, "paste", (ev) => handleClipboardEvent(ev, "onPaste"), { capture: false, passive: false });
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQ2xpcGJvYXJkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiQ2xpcGJvYXJkLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxvQkFBb0IsRUFBRSxNQUFNLDJCQUEyQixDQUFDO0FBU2pFLEVBQUU7QUFDRixNQUFNLGdCQUFnQixHQUFHLENBQUMsRUFBa0IsRUFBRSxNQUErQixFQUF1QixFQUFFO0lBQ2xHLE1BQU0sU0FBUyxHQUFHLElBQUksR0FBRyxFQUFxQixDQUFDO0lBQy9DLElBQUksRUFBRSxHQUFJLEVBQUUsRUFBRSxNQUE2QixJQUFJLFFBQVEsQ0FBQyxhQUFhLElBQUksUUFBUSxDQUFDLElBQUksQ0FBQztJQUV2RiwwRkFBMEY7SUFDMUYsSUFBSSxFQUFFLFlBQVksZ0JBQWdCLElBQUksRUFBRSxZQUFZLG1CQUFtQixJQUFLLEVBQWtCLENBQUMsaUJBQWlCLEVBQUUsQ0FBQztRQUMvRyxPQUFPLEVBQUUsQ0FBQztJQUNkLENBQUM7SUFFRCwyREFBMkQ7SUFDM0QsSUFBSSxPQUFPLEdBQXVCLEVBQWlCLENBQUM7SUFDcEQsT0FBTyxPQUFPLEVBQUUsQ0FBQztRQUNiLDZGQUE2RjtRQUM3RixJQUFJLE9BQVEsT0FBZSxDQUFDLE1BQU0sQ0FBQyxLQUFLLFVBQVUsRUFBRSxDQUFDO1lBQ2pELFNBQVMsQ0FBQyxHQUFHLENBQUMsT0FBYyxDQUFDLENBQUM7UUFDbEMsQ0FBQztRQUNELHFFQUFxRTtRQUNyRSxJQUFLLE9BQWUsQ0FBQyxpQkFBaUIsSUFBSSxPQUFRLE9BQWUsQ0FBQyxpQkFBaUIsQ0FBQyxNQUFNLENBQUMsS0FBSyxVQUFVLEVBQUUsQ0FBQztZQUN6RyxTQUFTLENBQUMsR0FBRyxDQUFFLE9BQWUsQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDO1FBQ3RELENBQUM7UUFFRCxVQUFVO1FBQ1YsSUFBSSxPQUFPLENBQUMsVUFBVSxJQUFLLE9BQU8sQ0FBQyxVQUFrQixDQUFDLElBQUksRUFBRSxDQUFDO1lBQ3pE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QUFPLEVBQUUsS0FBSyxFQUFFLE9BQU8sRUFBRSxJQUFJLEVBQUUsQ0FBQyxDQUFDO0lBQzdJLG9CQUFvQixDQUFDLE1BQU0sRUFBRSxLQUFLLEVBQUUsQ0FBQyxFQUFTLEVBQUUsRUFBRSxDQUFDLG9CQUFvQixDQUFDLEVBQW9CLEVBQUUsT0FBTyxDQUFDLEVBQUUsRUFBRSxPQUFPLEVBQUUsS0FBSyxFQUFFLE9BQU8sRUFBRSxJQUFJLEVBQUUsQ0FBQyxDQUFDO0lBQzNJLG9CQUFvQixDQUFDLE1BQU0sRUFBRSxPQUFPLEVBQUUsQ0FBQyxFQUFTLEVBQUUsRUFBRSxDQUFDLG9CQUFvQixDQUFDLEVBQW9CLEVBQUUsU0FBUyxDQUFDLEVBQUUsRUFBRSxPQUFPLEVBQUUsS0FBSyxFQUFFLE9BQU8sRUFBRSxLQUFLLEVBQUUsQ0FBQyxDQUFDO0FBQ3BKLENBQUMsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGxhenlBZGRFdmVudExpc3RlbmVyIH0gZnJvbSBcIi4uL2NvbnRyb2xsZXJzL0xhenlFdmVudHNcIjtcblxuLy9cbmV4cG9ydCBpbnRlcmZhY2UgQ2xpcGJvYXJkUHJvdmlkZXIge1xuICAgIG9uQ29weT8oZXY6IENsaXBib2FyZEV2ZW50KTogdm9pZCB8IGJvb2xlYW47XG4gICAgb25DdXQ/KGV2OiBDbGlwYm9hcmRFdmVudCk6IHZvaWQgfCBib29sZWFuO1xuICAgIG9uUGFzdGU/KGV2OiBDbGlwYm9hcmRFdmVudCk6IHZvaWQgfCBib29sZWFuO1xufVxuXG4vL1xuY29uc3QgY29sbGVjdFByb3ZpZGVycyA9IChldjogQ2xpcGJvYXJkRXZlbnQsIGFjdGlvbjoga2V5b2YgQ2xpcGJvYXJkUHJvdmlkZXIpOiBDbGlwYm9hcmRQcm92aWRlcltdID0+IHtcbiAgICBjb25zdCBwcm92aWRlcnMgPSBuZXcgU2V0PENsaXBib2FyZFByb3ZpZGVyPigpO1xuICAgIGxldCBlbCA9IChldj8udGFyZ2V0IGFzIEhUTUxFbGVtZW50IHwgbnVsbCkgfHwgZG9jdW1lbnQuYWN0aXZlRWxlbWVudCB8fCBkb2N1bWVudC5ib2R5O1xuXG4gICAgLy8gSWdub3JlIGlmIHRhcmdldCBpcyBhIG5hdGl2ZSBpbnB1dCB0aGF0IGhhbmRsZXMgY2xpcGJvYXJkICh1bmxlc3Mgd2Ugd2FudCB0byBvdmVycmlkZT8pXG4gICAgaWYgKGVsIGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCB8fCBlbCBpbnN0YW5jZW9mIEhUTUxUZXh0QXJlYUVsZW1lbnQgfHwgKGVsIGFzIEhUTUxFbGVtZW50KS5pc0NvbnRlbnRFZGl0YWJsZSkge1xuICAgICAgICByZXR1cm4gW107XG4gICAgfVxuXG4gICAgLy8gMS4gV2FsayB1cCB0aGUgdHJlZSAoYnViYmxpbmcgZW11bGF0aW9uIC8gZm9jdXMgY29udGV4dClcbiAgICBsZXQgY3VycmVudDogSFRNTEVsZW1lbnQgfCBudWxsID0gZWwgYXMgSFRNTEVsZW1lbnQ7XG4gICAgd2hpbGUgKGN1cnJlbnQpIHtcbiAgICAgICAgLy8gQ2hlY2sgaWYgZWxlbWVudCBpbnN0YW5jZSBoYXMgdGhlIG1ldGhvZHMgKGUuZy4gd2ViIGNvbXBvbmVudHMgb3IgY3VzdG9tIG9iamVjdHMgYXR0YWNoZWQpXG4gICAgICAgIGlmICh0eXBlb2YgKGN1cnJlbnQgYXMgYW55KVthY3Rpb25dID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgIHByb3ZpZGVycy5hZGQoY3VycmVudCBhcyBhbnkpO1xuICAgICAgICB9XG4gICAgICAgIC8vIEFsc28gY2hlY2sgaWYgdGhlcmUncyBhbiBvcGVyYXRpdmUgaW5zdGFuY2Ugb3IgY29udHJvbGxlciBhdHRhY2hlZFxuICAgICAgICBpZiAoKGN1cnJlbnQgYXMgYW55KS5vcGVyYXRpdmVJbnN0YW5jZSAmJiB0eXBlb2YgKGN1cnJlbnQgYXMgYW55KS5vcGVyYXRpdmVJbnN0YW5jZVthY3Rpb25dID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgIHByb3ZpZGVycy5hZGQoKGN1cnJlbnQgYXMgYW55KS5vcGVyYXRpdmVJbnN0YW5jZSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBNb3ZlIHVwXG4gICAgICAgIGlmIChjdXJyZW50LnNoYWRvd1Jvb3QgJiYgKGN1cnJlbnQuc2hhZG93Um9vdCBhcyBhbnkpLmhvc3QpIHtcbiAgICAgICAgICAgIGN1cnJlbnQgPSAoY3VycmVudC5zaGFkb3dSb290IGFzIGFueSkuaG9zdDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGN1cnJlbnQgPSAoY3VycmVudC5wYXJlbnRFbGVtZW50IHx8IChjdXJyZW50LmdldFJvb3ROb2RlKCkgYXMgU2hhZG93Um9vdCk/Lmhvc3QpIGFzIEhUTUxFbGVtZW50O1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLy8gMi4gVHJlZVdhbGtlciBTZWFyY2ggKGZhbGxiYWNrOiBmaW5kIGFueSBhY3RpdmUgcHJvdmlkZXIgaW4gdGhlIGNvbXBvc2VkIHRyZWUpXG4gICAgLy8gVGhpcyBpcyB1c2VmdWwgaWYgdGhlIGZvY3VzIGlzIG9uIGJvZHkvZG9jdW1lbnQgYnV0IGEgcHJvdmlkZXIgaXMgY29uY2VwdHVhbGx5IGFjdGl2ZSBvciB2aXNpYmxlXG4gICAgaWYgKGV2LmN1cnJlbnRUYXJnZXQgaW5zdGFuY2VvZiBOb2RlIHx8IHR5cGVvZiBkb2N1bWVudCAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgICBjb25zdCByb290ID0gKGV2LmN1cnJlbnRUYXJnZXQgaW5zdGFuY2VvZiBOb2RlID8gKGV2LmN1cnJlbnRUYXJnZXQgaW5zdGFuY2VvZiBEb2N1bWVudCA/IGV2LmN1cnJlbnRUYXJnZXQuYm9keSA6IGV2LmN1cnJlbnRUYXJnZXQpIDogZG9jdW1lbnQuYm9keSkgYXMgSFRNTEVsZW1lbnQ7XG4gICAgICAgIGlmIChyb290KSB7XG4gICAgICAgICAgICBjb25zdCB3YWxrZXIgPSBkb2N1bWVudC5jcmVhdGVUcmVlV2Fsa2VyKFxuICAgICAgICAgICAgICAgIHJvb3QsXG4gICAgICAgICAgICAgICAgTm9kZUZpbHRlci5TSE9XX0VMRU1FTlQsXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBhY2NlcHROb2RlKG5vZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgKG5vZGUgYXMgYW55KVthY3Rpb25dID09PSBcImZ1bmN0aW9uXCIgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICgobm9kZSBhcyBhbnkpLm9wZXJhdGl2ZUluc3RhbmNlICYmIHR5cGVvZiAobm9kZSBhcyBhbnkpLm9wZXJhdGl2ZUluc3RhbmNlW2FjdGlvbl0gPT09IFwiZnVuY3Rpb25cIikpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gTm9kZUZpbHRlci5GSUxURVJfQUNDRVBUO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIE5vZGVGaWx0ZXIuRklMVEVSX1NLSVA7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICApO1xuXG4gICAgICAgICAgICB3aGlsZSAod2Fsa2VyLm5leHROb2RlKCkpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBub2RlID0gd2Fsa2VyLmN1cnJlbnROb2RlIGFzIEhUTUxFbGVtZW50O1xuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgKG5vZGUgYXMgYW55KVthY3Rpb25dID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgcHJvdmlkZXJzLmFkZChub2RlIGFzIGFueSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICgobm9kZSBhcyBhbnkpLm9wZXJhdGl2ZUluc3RhbmNlICYmIHR5cGVvZiAobm9kZSBhcyBhbnkpLm9wZXJhdGl2ZUluc3RhbmNlW2FjdGlvbl0gPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgICAgICAgICBwcm92aWRlcnMuYWRkKChub2RlIGFzIGFueSkub3BlcmF0aXZlSW5zdGFuY2UpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBBcnJheS5mcm9tKHByb3ZpZGVycyk7XG59XG5cbi8vXG5jb25zdCBoYW5kbGVDbGlwYm9hcmRFdmVudCA9IChldjogQ2xpcGJvYXJkRXZlbnQsIHR5cGU6IFwib25Db3B5XCIgfCBcIm9uQ3V0XCIgfCBcIm9uUGFzdGVcIikgPT4ge1xuICAgIGNvbnN0IHByb3ZpZGVycyA9IGNvbGxlY3RQcm92aWRlcnMoZXYsIHR5cGUpO1xuICAgIGZvciAoY29uc3QgcHJvdmlkZXIgb2YgcHJvdmlkZXJzKSB7XG4gICAgICAgIHByb3ZpZGVyW3R5cGVdPy4oZXYpO1xuICAgIH1cbn07XG5cbi8vXG5sZXQgaW5pdGlhbGl6ZWQgPSBmYWxzZTtcbmV4cG9ydCBjb25zdCBpbml0R2xvYmFsQ2xpcGJvYXJkID0gKCkgPT4ge1xuICAgIGlmICh0eXBlb2Ygd2luZG93ID09PSBcInVuZGVmaW5lZFwiIHx8IGluaXRpYWxpemVkKSByZXR1cm47XG4gICAgaW5pdGlhbGl6ZWQgPSB0cnVlO1xuXG4gICAgLy8gTGF6aWx5IGF0dGFjaCAoc2luZ2xlIHNoYXJlZCBsaXN0ZW5lciBwZXIgZXZlbnQgdHlwZSkgb24gZmlyc3QgaW5pdC5cbiAgICBsYXp5QWRkRXZlbnRMaXN0ZW5lcih3aW5kb3csIFwiY29weVwiLCAoZXY6IEV2ZW50KSA9PiBoYW5kbGVDbGlwYm9hcmRFdmVudChldiBhcyBDbGlwYm9hcmRFdmVudCwgXCJvbkNvcHlcIiksIHsgY2FwdHVyZTogZmFsc2UsIHBhc3NpdmU6IHRydWUgfSk7XG4gICAgbGF6eUFkZEV2ZW50TGlzdGVuZXIod2luZG93LCBcImN1dFwiLCAoZXY6IEV2ZW50KSA9PiBoYW5kbGVDbGlwYm9hcmRFdmVudChldiBhcyBDbGlwYm9hcmRFdmVudCwgXCJvbkN1dFwiKSwgeyBjYXB0dXJlOiBmYWxzZSwgcGFzc2l2ZTogdHJ1ZSB9KTtcbiAgICBsYXp5QWRkRXZlbnRMaXN0ZW5lcih3aW5kb3csIFwicGFzdGVcIiwgKGV2OiBFdmVudCkgPT4gaGFuZGxlQ2xpcGJvYXJkRXZlbnQoZXYgYXMgQ2xpcGJvYXJkRXZlbnQsIFwib25QYXN0ZVwiKSwgeyBjYXB0dXJlOiBmYWxzZSwgcGFzc2l2ZTogZmFsc2UgfSk7XG59O1xuIl19