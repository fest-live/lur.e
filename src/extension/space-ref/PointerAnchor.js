import { addToCallChain, booleanRef, numberRef, stringRef } from "fest/object";
import { handleByPointer } from "../controllers/Handler";
import { WRef } from "fest/core";
//
export const pointerAnchorRef = (root = typeof document != "undefined" ? document?.documentElement : null) => {
    if (!root)
        return () => { };
    const coordinate = [numberRef(0), numberRef(0)];
    coordinate.push(WRef(handleByPointer((ev) => { coordinate[0].value = ev.clientX; coordinate[1].value = ev.clientY; }, root)));
    if (coordinate[2]?.deref?.() ?? coordinate[2]) {
        addToCallChain(coordinate, Symbol.dispose, coordinate[2]?.deref?.() ?? coordinate[2]);
    }
    return coordinate;
};
//
export const visibleBySelectorRef = (selector) => {
    const visRef = booleanRef(false), usub = handleByPointer((ev) => {
        const target = typeof document != "undefined" ? document.elementFromPoint(ev.clientX, ev.clientY) : null;
        visRef.value = target?.matches?.(selector) ?? false;
    });
    if (usub)
        addToCallChain(visRef, Symbol.dispose, usub);
    return visRef;
};
//
export const showAttributeRef = (attribute = "data-tooltip") => {
    const valRef = stringRef(""), usub = handleByPointer((ev) => {
        const target = typeof document != "undefined" ? document.elementFromPoint(ev.clientX, ev.clientY) : null;
        valRef.value = target?.getAttribute?.(attribute)?.(`[${attribute}]`) ?? "";
    });
    if (usub)
        addToCallChain(valRef, Symbol.dispose, usub);
    return valRef;
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiUG9pbnRlckFuY2hvci5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIlBvaW50ZXJBbmNob3IudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLGNBQWMsRUFBRSxVQUFVLEVBQUUsU0FBUyxFQUFFLFNBQVMsRUFBRSxNQUFNLGFBQWEsQ0FBQztBQUMvRSxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0sd0JBQXdCLENBQUM7QUFDekQsT0FBTyxFQUFFLElBQUksRUFBRSxNQUFNLFdBQVcsQ0FBQztBQUVqQyxFQUFFO0FBQ0YsTUFBTSxDQUFDLE1BQU0sZ0JBQWdCLEdBQUcsQ0FBQyxJQUFJLEdBQUcsT0FBTyxRQUFRLElBQUksV0FBVyxDQUFDLENBQUMsQ0FBQyxRQUFRLEVBQUUsZUFBZSxDQUFDLENBQUMsQ0FBQyxJQUFJLEVBQUMsRUFBRTtJQUN4RyxJQUFJLENBQUMsSUFBSTtRQUFFLE9BQU8sR0FBRyxFQUFFLEdBQUcsQ0FBQyxDQUFDO0lBQzVCLE1BQU0sVUFBVSxHQUFHLENBQUUsU0FBUyxDQUFDLENBQUMsQ0FBQyxFQUFFLFNBQVMsQ0FBQyxDQUFDLENBQUMsQ0FBRSxDQUFDO0lBQ2xELFVBQVUsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLGVBQWUsQ0FBQyxDQUFDLEVBQUUsRUFBQyxFQUFFLEdBQUUsVUFBVSxDQUFDLENBQUMsQ0FBQyxDQUFDLEtBQUssR0FBRyxFQUFFLENBQUMsT0FBTyxDQUFDLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQyxDQUFDLEtBQUssR0FBRyxFQUFFLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxFQUFFLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUM1SCxJQUFJLFVBQVUsQ0FBQyxDQUFDLENBQUMsRUFBRSxLQUFLLEVBQUUsRUFBRSxJQUFJLFVBQVUsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDO1FBQUMsY0FBYyxDQUFDLFVBQVUsRUFBRSxNQUFNLENBQUMsT0FBTyxFQUFFLFVBQVUsQ0FBQyxDQUFDLENBQUMsRUFBRSxLQUFLLEVBQUUsRUFBRSxJQUFJLFVBQVUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQUMsQ0FBQztJQUN6SSxPQUFPLFVBQVUsQ0FBQztBQUN0QixDQUFDLENBQUE7QUFFRCxFQUFFO0FBQ0YsTUFBTSxDQUFDLE1BQU0sb0JBQW9CLEdBQUcsQ0FBQyxRQUFRLEVBQUMsRUFBRTtJQUM1QyxNQUFNLE1BQU0sR0FBRyxVQUFVLENBQUMsS0FBSyxDQUFDLEVBQUUsSUFBSSxHQUFHLGVBQWUsQ0FBQyxDQUFDLEVBQUUsRUFBQyxFQUFFO1FBQzNELE1BQU0sTUFBTSxHQUFHLE9BQU8sUUFBUSxJQUFJLFdBQVcsQ0FBQyxDQUFDLENBQUMsUUFBUSxDQUFDLGdCQUFnQixDQUFDLEVBQUUsQ0FBQyxPQUFPLEVBQUUsRUFBRSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUM7UUFDekcsTUFBTSxDQUFDLEtBQUssR0FBRyxNQUFNLEVBQUUsT0FBTyxFQUFFLENBQUMsUUFBUSxDQUFDLElBQUksS0FBSyxDQUFDO0lBQ3hELENBQUMsQ0FBQyxDQUFDO0lBQ0gsSUFBSSxJQUFJO1FBQUUsY0FBYyxDQUFDLE1BQU0sRUFBRSxNQUFNLENBQUMsT0FBTyxFQUFFLElBQUksQ0FBQyxDQUFDO0lBQUMsT0FBTyxNQUFNLENBQUM7QUFDMUUsQ0FBQyxDQUFBO0FBRUQsRUFBRTtBQUNGLE1BQU0sQ0FBQyxNQUFNLGdCQUFnQixHQUFHLENBQUMsU0FBUyxHQUFHLGNBQWMsRUFBQyxFQUFFO0lBQzFELE1BQU0sTUFBTSxHQUFHLFNBQVMsQ0FBQyxFQUFFLENBQUMsRUFBRSxJQUFJLEdBQUcsZUFBZSxDQUFDLENBQUMsRUFBRSxFQUFDLEVBQUU7UUFDdkQsTUFBTSxNQUFNLEdBQVEsT0FBTyxRQUFRLElBQUksV0FBVyxDQUFDLENBQUMsQ0FBQyxRQUFRLENBQUMsZ0JBQWdCLENBQUMsRUFBRSxDQUFDLE9BQU8sRUFBRSxFQUFFLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQztRQUM5RyxNQUFNLENBQUMsS0FBSyxHQUFHLE1BQU0sRUFBRSxZQUFZLEVBQUUsQ0FBQyxTQUFTLENBQUMsRUFBRSxDQUFDLElBQUksU0FBUyxHQUFHLENBQUMsSUFBSSxFQUFFLENBQUM7SUFDL0UsQ0FBQyxDQUFDLENBQUM7SUFDSCxJQUFJLElBQUk7UUFBRSxjQUFjLENBQUMsTUFBTSxFQUFFLE1BQU0sQ0FBQyxPQUFPLEVBQUUsSUFBSSxDQUFDLENBQUM7SUFBQyxPQUFPLE1BQU0sQ0FBQztBQUMxRSxDQUFDLENBQUEiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBhZGRUb0NhbGxDaGFpbiwgYm9vbGVhblJlZiwgbnVtYmVyUmVmLCBzdHJpbmdSZWYgfSBmcm9tIFwiZmVzdC9vYmplY3RcIjtcbmltcG9ydCB7IGhhbmRsZUJ5UG9pbnRlciB9IGZyb20gXCIuLi9jb250cm9sbGVycy9IYW5kbGVyXCI7XG5pbXBvcnQgeyBXUmVmIH0gZnJvbSBcImZlc3QvY29yZVwiO1xuXG4vL1xuZXhwb3J0IGNvbnN0IHBvaW50ZXJBbmNob3JSZWYgPSAocm9vdCA9IHR5cGVvZiBkb2N1bWVudCAhPSBcInVuZGVmaW5lZFwiID8gZG9jdW1lbnQ/LmRvY3VtZW50RWxlbWVudCA6IG51bGwpPT57XG4gICAgaWYgKCFyb290KSByZXR1cm4gKCkgPT4geyB9O1xuICAgIGNvbnN0IGNvb3JkaW5hdGUgPSBbIG51bWJlclJlZigwKSwgbnVtYmVyUmVmKDApIF07XG4gICAgY29vcmRpbmF0ZS5wdXNoKFdSZWYoaGFuZGxlQnlQb2ludGVyKChldik9PnsgY29vcmRpbmF0ZVswXS52YWx1ZSA9IGV2LmNsaWVudFg7IGNvb3JkaW5hdGVbMV0udmFsdWUgPSBldi5jbGllbnRZOyB9LCByb290KSkpO1xuICAgIGlmIChjb29yZGluYXRlWzJdPy5kZXJlZj8uKCkgPz8gY29vcmRpbmF0ZVsyXSkgeyBhZGRUb0NhbGxDaGFpbihjb29yZGluYXRlLCBTeW1ib2wuZGlzcG9zZSwgY29vcmRpbmF0ZVsyXT8uZGVyZWY/LigpID8/IGNvb3JkaW5hdGVbMl0pOyB9XG4gICAgcmV0dXJuIGNvb3JkaW5hdGU7XG59XG5cbi8vXG5leHBvcnQgY29uc3QgdmlzaWJsZUJ5U2VsZWN0b3JSZWYgPSAoc2VsZWN0b3IpPT57XG4gICAgY29uc3QgdmlzUmVmID0gYm9vbGVhblJlZihmYWxzZSksIHVzdWIgPSBoYW5kbGVCeVBvaW50ZXIoKGV2KT0+e1xuICAgICAgICBjb25zdCB0YXJnZXQgPSB0eXBlb2YgZG9jdW1lbnQgIT0gXCJ1bmRlZmluZWRcIiA/IGRvY3VtZW50LmVsZW1lbnRGcm9tUG9pbnQoZXYuY2xpZW50WCwgZXYuY2xpZW50WSkgOiBudWxsO1xuICAgICAgICB2aXNSZWYudmFsdWUgPSB0YXJnZXQ/Lm1hdGNoZXM/LihzZWxlY3RvcikgPz8gZmFsc2U7XG4gICAgfSk7XG4gICAgaWYgKHVzdWIpIGFkZFRvQ2FsbENoYWluKHZpc1JlZiwgU3ltYm9sLmRpc3Bvc2UsIHVzdWIpOyByZXR1cm4gdmlzUmVmO1xufVxuXG4vL1xuZXhwb3J0IGNvbnN0IHNob3dBdHRyaWJ1dGVSZWYgPSAoYXR0cmlidXRlID0gXCJkYXRhLXRvb2x0aXBcIik9PntcbiAgICBjb25zdCB2YWxSZWYgPSBzdHJpbmdSZWYoXCJcIiksIHVzdWIgPSBoYW5kbGVCeVBvaW50ZXIoKGV2KT0+e1xuICAgICAgICBjb25zdCB0YXJnZXQ6IGFueSA9IHR5cGVvZiBkb2N1bWVudCAhPSBcInVuZGVmaW5lZFwiID8gZG9jdW1lbnQuZWxlbWVudEZyb21Qb2ludChldi5jbGllbnRYLCBldi5jbGllbnRZKSA6IG51bGw7XG4gICAgICAgIHZhbFJlZi52YWx1ZSA9IHRhcmdldD8uZ2V0QXR0cmlidXRlPy4oYXR0cmlidXRlKT8uKGBbJHthdHRyaWJ1dGV9XWApID8/IFwiXCI7XG4gICAgfSk7XG4gICAgaWYgKHVzdWIpIGFkZFRvQ2FsbENoYWluKHZhbFJlZiwgU3ltYm9sLmRpc3Bvc2UsIHVzdWIpOyByZXR1cm4gdmFsUmVmO1xufVxuIl19