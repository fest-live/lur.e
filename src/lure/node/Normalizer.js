//
export function getIndentColumns(line, tabWidth = 4) {
    let col = 0;
    for (let i = 0; i < line.length; i++) {
        const ch = line[i];
        if (ch === ' ')
            col += 1;
        else if (ch === '\t')
            col += tabWidth - (col % tabWidth);
        else
            break;
    }
    return col;
}
//
export function stripIndentColumns(line, columns, tabWidth = 4) {
    let col = 0, i = 0;
    while (i < line.length && col < columns) {
        const ch = line[i];
        if (ch === ' ') {
            col += 1;
            i++;
        }
        else if (ch === '\t') {
            col += tabWidth - (col % tabWidth);
            i++;
        }
        else
            break;
    }
    return line.slice(i);
}
//
export function pickEOL(s) {
    if (s.includes('\r\n'))
        return '\r\n';
    if (s.includes('\r'))
        return '\r';
    return '\n';
}
//
export function gcd(a, b) {
    a = Math.abs(a);
    b = Math.abs(b);
    while (b)
        [a, b] = [b, a % b];
    return a;
}
//
export function detectIndentStep(text, { ignoreFirstLine = true, tabWidth = 4 } = {}) {
    const lines = text.split(/\r\n|\n|\r/);
    const start = ignoreFirstLine ? 1 : 0;
    const indents = [];
    for (let i = start; i < lines.length; i++) {
        const ln = lines[i];
        if (ln.trim() === '')
            continue;
        indents.push(getIndentColumns(ln, tabWidth));
    }
    if (indents.length === 0)
        return { min: 0, step: 0, allEven: true, allDiv4: true };
    const min = Math.min(...indents);
    const shifted = indents.map(v => v - min).filter(v => v > 0);
    let step = 0;
    for (const v of shifted)
        step = step ? gcd(step, v) : v;
    const allEven = indents.every(v => v % 2 === 0);
    const allDiv4 = indents.every(v => v % 4 === 0);
    // Нормализация шага: предпочитаем 4, затем 2, иначе 1
    if (step === 0) {
        // все одинаково отступлены; берем по наблюдаемой кратности
        step = allDiv4 ? 4 : allEven ? 2 : 1;
    }
    else {
        if (step % 4 === 0)
            step = 4;
        else if (step % 2 === 0)
            step = 2;
        else
            step = 1;
    }
    return { min, step, allEven, allDiv4 };
}
//
export function adjustIndentToGrid(line, step, mode = 'floor', tabWidth = 4) {
    if (!step || step <= 1)
        return line; // нет смысла квантизовать к 1n
    const cur = getIndentColumns(line, tabWidth);
    if (cur === 0)
        return line; // нечего править
    let target;
    if (mode === 'nearest')
        target = Math.round(cur / step) * step;
    else if (mode === 'ceil')
        target = Math.ceil(cur / step) * step;
    else
        target = Math.floor(cur / step) * step;
    const delta = cur - target;
    if (delta > 0) {
        // уменьшаем отступ на delta колонок
        return stripIndentColumns(line, delta, tabWidth);
    }
    else if (delta < 0) {
        // увеличиваем пробелами (без смешивания табов) при необходимости
        return ' '.repeat(-delta) + line;
    }
    return line;
}
//
export function normalizeStartTagWhitespace(html, { scope = 'void-only' } = {}) {
    if (!html || typeof html !== 'string')
        return html;
    const VOID = new Set([
        'area', 'base', 'br', 'col', 'embed', 'hr', 'img', 'input', 'link', 'meta',
        'param', 'source', 'track', 'wbr'
    ]);
    let out = '';
    let i = 0;
    const n = html.length;
    while (i < n) {
        const ch = html[i];
        if (ch !== '<') {
            out += ch;
            i++;
            continue;
        }
        // Комментарии <!-- ... -->
        if (html.startsWith('<!--', i)) {
            const end = html.indexOf('-->', i + 4);
            if (end === -1) {
                out += html.slice(i);
                break;
            }
            out += html.slice(i, end + 3);
            i = end + 3;
            continue;
        }
        // DOCTYPE/DECL/CDATA/PI
        if (html[i + 1] === '!' || html[i + 1] === '?') {
            const end = html.indexOf('>', i + 2);
            if (end === -1) {
                out += html.slice(i);
                break;
            }
            out += html.slice(i, end + 1);
            i = end + 1;
            continue;
        }
        // Закрывающий тег
        if (html[i + 1] === '/') {
            const end = html.indexOf('>', i + 2);
            if (end === -1) {
                out += html.slice(i);
                break;
            }
            out += html.slice(i, end + 1);
            i = end + 1;
            continue;
        }
        // Открывающий тег
        let j = i + 1;
        // пропускаем пробелы после "<"
        while (j < n && /\s/.test(html[j]))
            j++;
        const nameStart = j;
        while (j < n && /[A-Za-z0-9:-]/.test(html[j]))
            j++;
        const tagName = html.slice(nameStart, j).toLowerCase();
        // Найти конец тега с учётом кавычек
        let k = j;
        let quote = null;
        while (k < n) {
            const c = html[k];
            if (quote) {
                if (c === quote)
                    quote = null;
                k++;
            }
            else {
                if (c === '"' || c === "'") {
                    quote = c;
                    k++;
                }
                else if (c === '>') {
                    break;
                }
                else {
                    k++;
                }
            }
        }
        if (k >= n) {
            out += html.slice(i);
            break;
        }
        const rawTag = html.slice(i, k + 1); // включая '>'
        const shouldNormalize = scope === 'all' ||
            (scope === 'input-only' && tagName === 'input') ||
            (scope === 'void-only' && VOID.has(tagName));
        if (!shouldNormalize) {
            out += rawTag;
            i = k + 1;
            continue;
        }
        // Нормализация пробелов внутри тега (вне кавычек)
        let res = '';
        let q = null;
        let ws = false;
        for (let p = 0; p < rawTag.length; p++) {
            const c = rawTag[p];
            if (q) {
                res += c;
                if (c === q)
                    q = null;
                continue;
            }
            if (c === '"' || c === "'") {
                q = c;
                res += c;
                ws = false;
                continue;
            }
            if (c === '\n' || c === '\r' || c === '\t' || c === ' ') {
                if (!ws) {
                    res += ' ';
                    ws = true;
                }
                continue;
            }
            res += c;
            ws = false;
        }
        // Удалить пробел перед '>' и '/>'
        res = res.replace(/\s*(\/?)\s*>$/, '$1>');
        out += res;
        i = k + 1;
    }
    return out;
}
//
export function collapseInterTagWhitespaceSmart(html, { preserveCommentGaps = true } = {}) {
    if (!html || typeof html !== 'string')
        return html;
    if (!preserveCommentGaps) {
        // Старое поведение
        return html.replace(/>\s+</g, '><');
    }
    // Маркер не-пробельного символа
    const SENT = '\u0001';
    let s = html;
    // 1) Помечаем одно-строчные промежутки вокруг комментариев:
    //    <!-- --> ␠ <!-- -->,  <!-- --> ␠ <tag,  <tag> ␠ <!-- -->
    //    [^\S\r\n]+ — только горизонтальные пробелы (без переводов строки)
    s = s
        .replace(/-->([^\S\r\n]+)<!--/g, `-->${SENT}<!--`)
        .replace(/-->([^\S\r\n]+)</g, `-->${SENT}<`)
        .replace(/>([^\S\r\n]+)<!--/g, `>${SENT}<!--`);
    // 2) Убираем все межтеговые пробелы (и с переводами строк)
    s = s.replace(/>\s+</g, '><');
    // 3) Возвращаем один пробел там, где он обязателен
    s = s.replace(new RegExp(SENT, 'g'), ' ');
    return s;
}
//
export function cleanupInterTagWhitespaceAndIndent(html, { normalizeIndent = true, // убрать общий минимальный отступ
ignoreFirstLine = true, // первую строку не учитываем при детекте
tabWidth = 4, // ширина таба в колонках
alignStep = 'auto', // сетка 2n/4n/1n
quantize = 'none', // квантизация к сетке
 } = {}) {
    if (!html || typeof html !== 'string' || html.indexOf('<') === -1)
        return html;
    html = html?.trim?.();
    //
    const placeholders = [];
    const protectedHtml = html.replace(/<(pre|textarea|script|style)\b[\s\S]*?<\/\1>/gi, (m) => {
        const i = placeholders.push(m) - 1;
        return `\u0000${i}\u0000`;
    });
    const eol = pickEOL(protectedHtml);
    const lines = protectedHtml.split(/\r\n|\n|\r/);
    const start = ignoreFirstLine ? 1 : 0;
    // 1) Детект шага и минимального отступа
    const { min, step: autoStep } = detectIndentStep(protectedHtml, { ignoreFirstLine, tabWidth });
    // 2) Dedent: убираем общий минимальный отступ
    if (normalizeIndent && min > 0) {
        for (let i = start; i < lines.length; i++) {
            const ln = lines[i];
            if (ln.trim() === '')
                continue;
            lines[i] = stripIndentColumns(ln, min, tabWidth);
        }
    }
    // 3) Квантизация к сетке 2n/4n по желанию
    let step = alignStep === 'auto' ? autoStep : alignStep;
    if (quantize !== 'none' && step > 1) {
        for (let i = start; i < lines.length; i++) {
            const ln = lines[i];
            if (ln.trim() === '')
                continue;
            lines[i] = adjustIndentToGrid(ln, step, quantize, tabWidth);
        }
    }
    // 4) Склеиваем и убираем межтеговые пробелы/переводы строк
    let working = lines.join(eol);
    // 5) ...dedent/квантизация
    working = normalizeStartTagWhitespace(working, { scope: 'void-only' });
    // 6) убрать межтеговые пробелы
    working = collapseInterTagWhitespaceSmart(working);
    // 7) Возвращаем защищённые блоки
    const cleaned = working.replace(/\u0000(\d+)\u0000/g, (_, i) => placeholders[+i]);
    return cleaned?.trim?.();
}
//
export function checkInsideTagBlock(contextParts, ...str) {
    const current = str?.[0] ?? "";
    const idx = contextParts.indexOf(current);
    // Fallback simple heuristic if index not found
    if (idx < 0) {
        const tail = (str?.join?.("") ?? "");
        return /<([A-Za-z\/!?])[\w\W]*$/.test(tail) && !/>[\w\W]*$/.test(tail);
    }
    // Scan all static parts up to and including the current part
    const prefix = contextParts.slice(0, idx + 1).join("");
    let inTag = false, inSingle = false, inDouble = false;
    for (let i = 0; i < prefix.length; i++) {
        const ch = prefix[i];
        const next = prefix[i + 1] ?? '';
        if (!inTag) {
            if (ch === '<') {
                // Treat as a tag only if followed by a likely opener: letter, '/', '!', or '?'
                if (/[A-Za-z\/!?]/.test(next)) {
                    inTag = true;
                    inSingle = false;
                    inDouble = false;
                }
            }
            continue;
        }
        if (!inSingle && !inDouble) {
            if (ch === '"') {
                inDouble = true;
                continue;
            }
            if (ch === "'") {
                inSingle = true;
                continue;
            }
            if (ch === '>') {
                inTag = false;
                continue;
            }
        }
        else if (inDouble) {
            if (ch === '"') {
                inDouble = false;
                continue;
            }
        }
        else if (inSingle) {
            if (ch === "'") {
                inSingle = false;
                continue;
            }
        }
    }
    return inTag;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiTm9ybWFsaXplci5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIk5vcm1hbGl6ZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQ0EsRUFBRTtBQUNGLE1BQU0sVUFBVSxnQkFBZ0IsQ0FBQyxJQUFZLEVBQUUsUUFBUSxHQUFHLENBQUM7SUFDdkQsSUFBSSxHQUFHLEdBQUcsQ0FBQyxDQUFDO0lBQ1osS0FBSyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLElBQUksQ0FBQyxNQUFNLEVBQUUsQ0FBQyxFQUFFLEVBQUUsQ0FBQztRQUNuQyxNQUFNLEVBQUUsR0FBRyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDbkIsSUFBSSxFQUFFLEtBQUssR0FBRztZQUFFLEdBQUcsSUFBSSxDQUFDLENBQUM7YUFDcEIsSUFBSSxFQUFFLEtBQUssSUFBSTtZQUFFLEdBQUcsSUFBSSxRQUFRLEdBQUcsQ0FBQyxHQUFHLEdBQUcsUUFBUSxDQUFDLENBQUM7O1lBQ3BELE1BQU07SUFDZixDQUFDO0lBQ0QsT0FBTyxHQUFHLENBQUM7QUFDZixDQUFDO0FBRUQsRUFBRTtBQUNGLE1BQU0sVUFBVSxrQkFBa0IsQ0FBQyxJQUFZLEVBQUUsT0FBZSxFQUFFLFFBQVEsR0FBRyxDQUFDO0lBQzFFLElBQUksR0FBRyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsQ0FBQyxDQUFDO0lBQ25CLE9BQU8sQ0FBQyxHQUFHLElBQUksQ0FBQyxNQUFNLElBQUksR0FBRyxHQUFHLE9BQU8sRUFBRSxDQUFDO1FBQ3RDLE1BQU0sRUFBRSxHQUFHLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUNuQixJQUFJLEVBQUUsS0FBSyxHQUFHLEVBQUUsQ0FBQztZQUFDLEdBQUcsSUFBSSxDQUFDLENBQUM7WUFBQyxDQUFDLEVBQUUsQ0FBQztRQUFDLENBQUM7YUFDN0IsSUFBSSxFQUFFLEtBQUssSUFBSSxFQUFFLENBQUM7WUFBQyxHQUFHLElBQUksUUFBUSxHQUFHLENB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akIsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbIlxuLy9cbmV4cG9ydCBmdW5jdGlvbiBnZXRJbmRlbnRDb2x1bW5zKGxpbmU6IHN0cmluZywgdGFiV2lkdGggPSA0KTogbnVtYmVyIHtcbiAgICBsZXQgY29sID0gMDtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxpbmUubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgY29uc3QgY2ggPSBsaW5lW2ldO1xuICAgICAgICBpZiAoY2ggPT09ICcgJykgY29sICs9IDE7XG4gICAgICAgIGVsc2UgaWYgKGNoID09PSAnXFx0JykgY29sICs9IHRhYldpZHRoIC0gKGNvbCAlIHRhYldpZHRoKTtcbiAgICAgICAgZWxzZSBicmVhaztcbiAgICB9XG4gICAgcmV0dXJuIGNvbDtcbn1cblxuLy9cbmV4cG9ydCBmdW5jdGlvbiBzdHJpcEluZGVudENvbHVtbnMobGluZTogc3RyaW5nLCBjb2x1bW5zOiBudW1iZXIsIHRhYldpZHRoID0gNCk6IHN0cmluZyB7XG4gICAgbGV0IGNvbCA9IDAsIGkgPSAwO1xuICAgIHdoaWxlIChpIDwgbGluZS5sZW5ndGggJiYgY29sIDwgY29sdW1ucykge1xuICAgICAgICBjb25zdCBjaCA9IGxpbmVbaV07XG4gICAgICAgIGlmIChjaCA9PT0gJyAnKSB7IGNvbCArPSAxOyBpKys7IH1cbiAgICAgICAgZWxzZSBpZiAoY2ggPT09ICdcXHQnKSB7IGNvbCArPSB0YWJXaWR0aCAtIChjb2wgJSB0YWJXaWR0aCk7IGkrKzsgfVxuICAgICAgICBlbHNlIGJyZWFrO1xuICAgIH1cbiAgICByZXR1cm4gbGluZS5zbGljZShpKTtcbn1cblxuLy9cbmV4cG9ydCBmdW5jdGlvbiBwaWNrRU9MKHM6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgaWYgKHMuaW5jbHVkZXMoJ1xcclxcbicpKSByZXR1cm4gJ1xcclxcbic7XG4gICAgaWYgKHMuaW5jbHVkZXMoJ1xccicpKSByZXR1cm4gJ1xccic7XG4gICAgcmV0dXJuICdcXG4nO1xufVxuXG4vL1xuZXhwb3J0IGZ1bmN0aW9uIGdjZChhOiBudW1iZXIsIGI6IG51bWJlcik6IG51bWJlciB7XG4gICAgYSA9IE1hdGguYWJzKGEpOyBiID0gTWF0aC5hYnMoYik7XG4gICAgd2hpbGUgKGIpIFthLCBiXSA9IFtiLCBhICUgYl07XG4gICAgcmV0dXJuIGE7XG59XG5cbi8vXG5leHBvcnQgZnVuY3Rpb24gZGV0ZWN0SW5kZW50U3RlcChcbiAgICB0ZXh0OiBzdHJpbmcsXG4gICAgeyBpZ25vcmVGaXJzdExpbmUgPSB0cnVlLCB0YWJXaWR0aCA9IDQgfSA9IHt9XG4pOiB7IG1pbjogbnVtYmVyOyBzdGVwOiBudW1iZXI7IGFsbEV2ZW46IGJvb2xlYW47IGFsbERpdjQ6IGJvb2xlYW4gfSB7XG4gICAgY29uc3QgbGluZXMgPSB0ZXh0LnNwbGl0KC9cXHJcXG58XFxufFxcci8pO1xuICAgIGNvbnN0IHN0YXJ0ID0gaWdub3JlRmlyc3RMaW5lID8gMSA6IDA7XG5cbiAgICBjb25zdCBpbmRlbnRzOiBudW1iZXJbXSA9IFtdO1xuICAgIGZvciAobGV0IGkgPSBzdGFydDsgaSA8IGxpbmVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGNvbnN0IGxuID0gbGluZXNbaV07XG4gICAgICAgIGlmIChsbi50cmltKCkgPT09ICcnKSBjb250aW51ZTtcbiAgICAgICAgaW5kZW50cy5wdXNoKGdldEluZGVudENvbHVtbnMobG4sIHRhYldpZHRoKSk7XG4gICAgfVxuICAgIGlmIChpbmRlbnRzLmxlbmd0aCA9PT0gMCkgcmV0dXJuIHsgbWluOiAwLCBzdGVwOiAwLCBhbGxFdmVuOiB0cnVlLCBhbGxEaXY0OiB0cnVlIH07XG5cbiAgICBjb25zdCBtaW4gPSBNYXRoLm1pbiguLi5pbmRlbnRzKTtcbiAgICBjb25zdCBzaGlmdGVkID0gaW5kZW50cy5tYXAodiA9PiB2IC0gbWluKS5maWx0ZXIodiA9PiB2ID4gMCk7XG4gICAgbGV0IHN0ZXAgPSAwO1xuICAgIGZvciAoY29uc3QgdiBvZiBzaGlmdGVkKSBzdGVwID0gc3RlcCA/IGdjZChzdGVwLCB2KSA6IHY7XG5cbiAgICBjb25zdCBhbGxFdmVuID0gaW5kZW50cy5ldmVyeSh2ID0+IHYgJSAyID09PSAwKTtcbiAgICBjb25zdCBhbGxEaXY0ID0gaW5kZW50cy5ldmVyeSh2ID0+IHYgJSA0ID09PSAwKTtcblxuICAgIC8vINCd0L7RgNC80LDQu9C40LfQsNGG0LjRjyDRiNCw0LPQsDog0L/RgNC10LTQv9C+0YfQuNGC0LDQtdC8IDQsINC30LDRgtC10LwgMiwg0LjQvdCw0YfQtSAxXG4gICAgaWYgKHN0ZXAgPT09IDApIHtcbiAgICAgICAgLy8g0LLRgdC1INC+0LTQuNC90LDQutC+0LLQviDQvtGC0YHRgtGD0L/Qu9C10L3Rizsg0LHQtdGA0LXQvCDQv9C+INC90LDQsdC70Y7QtNCw0LXQvNC+0Lkg0LrRgNCw0YLQvdC+0YHRgtC4XG4gICAgICAgIHN0ZXAgPSBhbGxEaXY0ID8gNCA6IGFsbEV2ZW4gPyAyIDogMTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBpZiAoc3RlcCAlIDQgPT09IDApIHN0ZXAgPSA0O1xuICAgICAgICBlbHNlIGlmIChzdGVwICUgMiA9PT0gMCkgc3RlcCA9IDI7XG4gICAgICAgIGVsc2Ugc3RlcCA9IDE7XG4gICAgfVxuXG4gICAgcmV0dXJuIHsgbWluLCBzdGVwLCBhbGxFdmVuLCBhbGxEaXY0IH07XG59XG5cbi8vXG5leHBvcnQgZnVuY3Rpb24gYWRqdXN0SW5kZW50VG9HcmlkKFxuICAgIGxpbmU6IHN0cmluZyxcbiAgICBzdGVwOiBudW1iZXIsXG4gICAgbW9kZTogJ2Zsb29yJyB8ICduZWFyZXN0JyB8ICdjZWlsJyA9ICdmbG9vcicsXG4gICAgdGFiV2lkdGggPSA0XG4pOiBzdHJpbmcge1xuICAgIGlmICghc3RlcCB8fCBzdGVwIDw9IDEpIHJldHVybiBsaW5lOyAvLyDQvdC10YIg0YHQvNGL0YHQu9CwINC60LLQsNC90YLQuNC30L7QstCw0YLRjCDQuiAxblxuICAgIGNvbnN0IGN1ciA9IGdldEluZGVudENvbHVtbnMobGluZSwgdGFiV2lkdGgpO1xuICAgIGlmIChjdXIgPT09IDApIHJldHVybiBsaW5lOyAvLyDQvdC10YfQtdCz0L4g0L/RgNCw0LLQuNGC0YxcbiAgICBsZXQgdGFyZ2V0OiBudW1iZXI7XG4gICAgaWYgKG1vZGUgPT09ICduZWFyZXN0JykgdGFyZ2V0ID0gTWF0aC5yb3VuZChjdXIgLyBzdGVwKSAqIHN0ZXA7XG4gICAgZWxzZSBpZiAobW9kZSA9PT0gJ2NlaWwnKSB0YXJnZXQgPSBNYXRoLmNlaWwoY3VyIC8gc3RlcCkgKiBzdGVwO1xuICAgIGVsc2UgdGFyZ2V0ID0gTWF0aC5mbG9vcihjdXIgLyBzdGVwKSAqIHN0ZXA7XG5cbiAgICBjb25zdCBkZWx0YSA9IGN1ciAtIHRhcmdldDtcbiAgICBpZiAoZGVsdGEgPiAwKSB7XG4gICAgICAgIC8vINGD0LzQtdC90YzRiNCw0LXQvCDQvtGC0YHRgtGD0L8g0L3QsCBkZWx0YSDQutC+0LvQvtC90L7QulxuICAgICAgICByZXR1cm4gc3RyaXBJbmRlbnRDb2x1bW5zKGxpbmUsIGRlbHRhLCB0YWJXaWR0aCk7XG4gICAgfSBlbHNlIGlmIChkZWx0YSA8IDApIHtcbiAgICAgICAgLy8g0YPQstC10LvQuNGH0LjQstCw0LXQvCDQv9GA0L7QsdC10LvQsNC80LggKNCx0LXQtyDRgdC80LXRiNC40LLQsNC90LjRjyDRgtCw0LHQvtCyKSDQv9GA0Lgg0L3QtdC+0LHRhdC+0LTQuNC80L7RgdGC0LhcbiAgICAgICAgcmV0dXJuICcgJy5yZXBlYXQoLWRlbHRhKSArIGxpbmU7XG4gICAgfVxuICAgIHJldHVybiBsaW5lO1xufVxuXG4vL1xuZXhwb3J0IGZ1bmN0aW9uIG5vcm1hbGl6ZVN0YXJ0VGFnV2hpdGVzcGFjZShcbiAgICBodG1sOiBzdHJpbmcsXG4gICAgeyBzY29wZSA9ICd2b2lkLW9ubHknIGFzICd2b2lkLW9ubHknIHwgJ2lucHV0LW9ubHknIHwgJ2FsbCcgfSA9IHt9XG4pOiBzdHJpbmcge1xuICAgIGlmICghaHRtbCB8fCB0eXBlb2YgaHRtbCAhPT0gJ3N0cmluZycpIHJldHVybiBodG1sO1xuXG4gICAgY29uc3QgVk9JRCA9IG5ldyBTZXQoW1xuICAgICAgICAnYXJlYScsICdiYXNlJywgJ2JyJywgJ2NvbCcsICdlbWJlZCcsICdocicsICdpbWcnLCAnaW5wdXQnLCAnbGluaycsICdtZXRhJyxcbiAgICAgICAgJ3BhcmFtJywgJ3NvdXJjZScsICd0cmFjaycsICd3YnInXG4gICAgXSk7XG5cbiAgICBsZXQgb3V0ID0gJyc7XG4gICAgbGV0IGkgPSAwO1xuICAgIGNvbnN0IG4gPSBodG1sLmxlbmd0aDtcblxuICAgIHdoaWxlIChpIDwgbikge1xuICAgICAgICBjb25zdCBjaCA9IGh0bWxbaV07XG4gICAgICAgIGlmIChjaCAhPT0gJzwnKSB7IG91dCArPSBjaDsgaSsrOyBjb250aW51ZTsgfVxuXG4gICAgICAgIC8vINCa0L7QvNC80LXQvdGC0LDRgNC40LggPCEtLSAuLi4gLS0+XG4gICAgICAgIGlmIChodG1sLnN0YXJ0c1dpdGgoJzwhLS0nLCBpKSkge1xuICAgICAgICAgICAgY29uc3QgZW5kID0gaHRtbC5pbmRleE9mKCctLT4nLCBpICsgNCk7XG4gICAgICAgICAgICBpZiAoZW5kID09PSAtMSkgeyBvdXQgKz0gaHRtbC5zbGljZShpKTsgYnJlYWs7IH1cbiAgICAgICAgICAgIG91dCArPSBodG1sLnNsaWNlKGksIGVuZCArIDMpO1xuICAgICAgICAgICAgaSA9IGVuZCArIDM7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICAvLyBET0NUWVBFL0RFQ0wvQ0RBVEEvUElcbiAgICAgICAgaWYgKGh0bWxbaSArIDFdID09PSAnIScgfHwgaHRtbFtpICsgMV0gPT09ICc/Jykge1xuICAgICAgICAgICAgY29uc3QgZW5kID0gaHRtbC5pbmRleE9mKCc+JywgaSArIDIpO1xuICAgICAgICAgICAgaWYgKGVuZCA9PT0gLTEpIHsgb3V0ICs9IGh0bWwuc2xpY2UoaSk7IGJyZWFrOyB9XG4gICAgICAgICAgICBvdXQgKz0gaHRtbC5zbGljZShpLCBlbmQgKyAxKTtcbiAgICAgICAgICAgIGkgPSBlbmQgKyAxO1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgLy8g0JfQsNC60YDRi9Cy0LDRjtGJ0LjQuSDRgtC10LNcbiAgICAgICAgaWYgKGh0bWxbaSArIDFdID09PSAnLycpIHtcbiAgICAgICAgICAgIGNvbnN0IGVuZCA9IGh0bWwuaW5kZXhPZignPicsIGkgKyAyKTtcbiAgICAgICAgICAgIGlmIChlbmQgPT09IC0xKSB7IG91dCArPSBodG1sLnNsaWNlKGkpOyBicmVhazsgfVxuICAgICAgICAgICAgb3V0ICs9IGh0bWwuc2xpY2UoaSwgZW5kICsgMSk7XG4gICAgICAgICAgICBpID0gZW5kICsgMTtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8g0J7RgtC60YDRi9Cy0LDRjtGJ0LjQuSDRgtC10LNcbiAgICAgICAgbGV0IGogPSBpICsgMTtcbiAgICAgICAgLy8g0L/RgNC+0L/Rg9GB0LrQsNC10Lwg0L/RgNC+0LHQtdC70Ysg0L/QvtGB0LvQtSBcIjxcIlxuICAgICAgICB3aGlsZSAoaiA8IG4gJiYgL1xccy8udGVzdChodG1sW2pdKSkgaisrO1xuICAgICAgICBjb25zdCBuYW1lU3RhcnQgPSBqO1xuICAgICAgICB3aGlsZSAoaiA8IG4gJiYgL1tBLVphLXowLTk6LV0vLnRlc3QoaHRtbFtqXSkpIGorKztcbiAgICAgICAgY29uc3QgdGFnTmFtZSA9IGh0bWwuc2xpY2UobmFtZVN0YXJ0LCBqKS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAvLyDQndCw0LnRgtC4INC60L7QvdC10YYg0YLQtdCz0LAg0YEg0YPRh9GR0YLQvtC8INC60LDQstGL0YfQtdC6XG4gICAgICAgIGxldCBrID0gajtcbiAgICAgICAgbGV0IHF1b3RlOiAnXCInIHwgXCInXCIgfCBudWxsID0gbnVsbDtcbiAgICAgICAgd2hpbGUgKGsgPCBuKSB7XG4gICAgICAgICAgICBjb25zdCBjID0gaHRtbFtrXTtcbiAgICAgICAgICAgIGlmIChxdW90ZSkge1xuICAgICAgICAgICAgICAgIGlmIChjID09PSBxdW90ZSkgcXVvdGUgPSBudWxsO1xuICAgICAgICAgICAgICAgIGsrKztcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKGMgPT09ICdcIicgfHwgYyA9PT0gXCInXCIpIHsgcXVvdGUgPSBjIGFzICdcIicgfCBcIidcIjsgaysrOyB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoYyA9PT0gJz4nKSB7IGJyZWFrOyB9XG4gICAgICAgICAgICAgICAgZWxzZSB7IGsrKzsgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChrID49IG4pIHsgb3V0ICs9IGh0bWwuc2xpY2UoaSk7IGJyZWFrOyB9XG4gICAgICAgIGNvbnN0IHJhd1RhZyA9IGh0bWwuc2xpY2UoaSwgayArIDEpOyAvLyDQstC60LvRjtGH0LDRjyAnPidcblxuICAgICAgICBjb25zdCBzaG91bGROb3JtYWxpemUgPVxuICAgICAgICAgICAgc2NvcGUgPT09ICdhbGwnIHx8XG4gICAgICAgICAgICAoc2NvcGUgPT09ICdpbnB1dC1vbmx5JyAmJiB0YWdOYW1lID09PSAnaW5wdXQnKSB8fFxuICAgICAgICAgICAgKHNjb3BlID09PSAndm9pZC1vbmx5JyAmJiBWT0lELmhhcyh0YWdOYW1lKSk7XG5cbiAgICAgICAgaWYgKCFzaG91bGROb3JtYWxpemUpIHtcbiAgICAgICAgICAgIG91dCArPSByYXdUYWc7XG4gICAgICAgICAgICBpID0gayArIDE7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vINCd0L7RgNC80LDQu9C40LfQsNGG0LjRjyDQv9GA0L7QsdC10LvQvtCyINCy0L3Rg9GC0YDQuCDRgtC10LPQsCAo0LLQvdC1INC60LDQstGL0YfQtdC6KVxuICAgICAgICBsZXQgcmVzID0gJyc7XG4gICAgICAgIGxldCBxOiAnXCInIHwgXCInXCIgfCBudWxsID0gbnVsbDtcbiAgICAgICAgbGV0IHdzID0gZmFsc2U7XG4gICAgICAgIGZvciAobGV0IHAgPSAwOyBwIDwgcmF3VGFnLmxlbmd0aDsgcCsrKSB7XG4gICAgICAgICAgICBjb25zdCBjID0gcmF3VGFnW3BdO1xuICAgICAgICAgICAgaWYgKHEpIHtcbiAgICAgICAgICAgICAgICByZXMgKz0gYztcbiAgICAgICAgICAgICAgICBpZiAoYyA9PT0gcSkgcSA9IG51bGw7XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoYyA9PT0gJ1wiJyB8fCBjID09PSBcIidcIikgeyBxID0gYyBhcyAnXCInIHwgXCInXCI7IHJlcyArPSBjOyB3cyA9IGZhbHNlOyBjb250aW51ZTsgfVxuICAgICAgICAgICAgaWYgKGMgPT09ICdcXG4nIHx8IGMgPT09ICdcXHInIHx8IGMgPT09ICdcXHQnIHx8IGMgPT09ICcgJykge1xuICAgICAgICAgICAgICAgIGlmICghd3MpIHsgcmVzICs9ICcgJzsgd3MgPSB0cnVlOyB9XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXMgKz0gYztcbiAgICAgICAgICAgIHdzID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgLy8g0KPQtNCw0LvQuNGC0Ywg0L/RgNC+0LHQtdC7INC/0LXRgNC10LQgJz4nINC4ICcvPidcbiAgICAgICAgcmVzID0gcmVzLnJlcGxhY2UoL1xccyooXFwvPylcXHMqPiQvLCAnJDE+Jyk7XG5cbiAgICAgICAgb3V0ICs9IHJlcztcbiAgICAgICAgaSA9IGsgKyAxO1xuICAgIH1cblxuICAgIHJldHVybiBvdXQ7XG59XG5cbi8vXG5leHBvcnQgZnVuY3Rpb24gY29sbGFwc2VJbnRlclRhZ1doaXRlc3BhY2VTbWFydChcbiAgICBodG1sOiBzdHJpbmcsXG4gICAgeyBwcmVzZXJ2ZUNvbW1lbnRHYXBzID0gdHJ1ZSB9ID0ge31cbik6IHN0cmluZyB7XG4gICAgaWYgKCFodG1sIHx8IHR5cGVvZiBodG1sICE9PSAnc3RyaW5nJykgcmV0dXJuIGh0bWw7XG5cbiAgICBpZiAoIXByZXNlcnZlQ29tbWVudEdhcHMpIHtcbiAgICAgICAgLy8g0KHRgtCw0YDQvtC1INC/0L7QstC10LTQtdC90LjQtVxuICAgICAgICByZXR1cm4gaHRtbC5yZXBsYWNlKC8+XFxzKzwvZywgJz48Jyk7XG4gICAgfVxuXG4gICAgLy8g0JzQsNGA0LrQtdGAINC90LUt0L/RgNC+0LHQtdC70YzQvdC+0LPQviDRgdC40LzQstC+0LvQsFxuICAgIGNvbnN0IFNFTlQgPSAnXFx1MDAwMSc7XG5cbiAgICBsZXQgcyA9IGh0bWw7XG5cbiAgICAvLyAxKSDQn9C+0LzQtdGH0LDQtdC8INC+0LTQvdC+LdGB0YLRgNC+0YfQvdGL0LUg0L/RgNC+0LzQtdC20YPRgtC60Lgg0LLQvtC60YDRg9CzINC60L7QvNC80LXQvdGC0LDRgNC40LXQsjpcbiAgICAvLyAgICA8IS0tIC0tPiDikKAgPCEtLSAtLT4sICA8IS0tIC0tPiDikKAgPHRhZywgIDx0YWc+IOKQoCA8IS0tIC0tPlxuICAgIC8vICAgIFteXFxTXFxyXFxuXSsg4oCUINGC0L7Qu9GM0LrQviDQs9C+0YDQuNC30L7QvdGC0LDQu9GM0L3Ri9C1INC/0YDQvtCx0LXQu9GLICjQsdC10Lcg0L/QtdGA0LXQstC+0LTQvtCyINGB0YLRgNC+0LrQuClcbiAgICBzID0gc1xuICAgICAgICAucmVwbGFjZSgvLS0+KFteXFxTXFxyXFxuXSspPCEtLS9nLCBgLS0+JHtTRU5UfTwhLS1gKVxuICAgICAgICAucmVwbGFjZSgvLS0+KFteXFxTXFxyXFxuXSspPC9nLCBgLS0+JHtTRU5UfTxgKVxuICAgICAgICAucmVwbGFjZSgvPihbXlxcU1xcclxcbl0rKTwhLS0vZywgYD4ke1NFTlR9PCEtLWApO1xuXG4gICAgLy8gMikg0KPQsdC40YDQsNC10Lwg0LLRgdC1INC80LXQttGC0LXQs9C+0LLRi9C1INC/0YDQvtCx0LXQu9GLICjQuCDRgSDQv9C10YDQtdCy0L7QtNCw0LzQuCDRgdGC0YDQvtC6KVxuICAgIHMgPSBzLnJlcGxhY2UoLz5cXHMrPC9nLCAnPjwnKTtcblxuICAgIC8vIDMpINCS0L7Qt9Cy0YDQsNGJ0LDQtdC8INC+0LTQuNC9INC/0YDQvtCx0LXQuyDRgtCw0LwsINCz0LTQtSDQvtC9INC+0LHRj9C30LDRgtC10LvQtdC9XG4gICAgcyA9IHMucmVwbGFjZShuZXcgUmVnRXhwKFNFTlQsICdnJyksICcgJyk7XG5cbiAgICByZXR1cm4gcztcbn1cblxuLy9cbmV4cG9ydCBmdW5jdGlvbiBjbGVhbnVwSW50ZXJUYWdXaGl0ZXNwYWNlQW5kSW5kZW50KFxuICAgIGh0bWw6IHN0cmluZyxcbiAgICB7XG4gICAgICAgIG5vcm1hbGl6ZUluZGVudCA9IHRydWUsICAgICAgICAgIC8vINGD0LHRgNCw0YLRjCDQvtCx0YnQuNC5INC80LjQvdC40LzQsNC70YzQvdGL0Lkg0L7RgtGB0YLRg9C/XG4gICAgICAgIGlnbm9yZUZpcnN0TGluZSA9IHRydWUsICAgICAgICAgIC8vINC/0LXRgNCy0YPRjiDRgdGC0YDQvtC60YMg0L3QtSDRg9GH0LjRgtGL0LLQsNC10Lwg0L/RgNC4INC00LXRgtC10LrRgtC1XG4gICAgICAgIHRhYldpZHRoID0gNCwgICAgICAgICAgICAgICAgICAgIC8vINGI0LjRgNC40L3QsCDRgtCw0LHQsCDQsiDQutC+0LvQvtC90LrQsNGFXG4gICAgICAgIGFsaWduU3RlcCA9ICdhdXRvJyBhcyAnYXV0bycgfCAxIHwgMiB8IDQsIC8vINGB0LXRgtC60LAgMm4vNG4vMW5cbiAgICAgICAgcXVhbnRpemUgPSAnbm9uZScgYXMgJ25vbmUnIHwgJ2Zsb29yJyB8ICduZWFyZXN0JyB8ICdjZWlsJywgLy8g0LrQstCw0L3RgtC40LfQsNGG0LjRjyDQuiDRgdC10YLQutC1XG4gICAgfSA9IHt9XG4pOiBzdHJpbmcge1xuICAgIGlmICghaHRtbCB8fCB0eXBlb2YgaHRtbCAhPT0gJ3N0cmluZycgfHwgaHRtbC5pbmRleE9mKCc8JykgPT09IC0xKSByZXR1cm4gaHRtbDtcbiAgICBodG1sID0gaHRtbD8udHJpbT8uKCk7XG5cbiAgICAvL1xuICAgIGNvbnN0IHBsYWNlaG9sZGVyczogc3RyaW5nW10gPSBbXTtcbiAgICBjb25zdCBwcm90ZWN0ZWRIdG1sID0gaHRtbC5yZXBsYWNlKFxuICAgICAgICAvPChwcmV8dGV4dGFyZWF8c2NyaXB0fHN0eWxlKVxcYltcXHNcXFNdKj88XFwvXFwxPi9naSxcbiAgICAgICAgKG0pID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGkgPSBwbGFjZWhvbGRlcnMucHVzaChtKSAtIDE7XG4gICAgICAgICAgICByZXR1cm4gYFxcdTAwMDAke2l9XFx1MDAwMGA7XG4gICAgICAgIH1cbiAgICApO1xuXG4gICAgY29uc3QgZW9sID0gcGlja0VPTChwcm90ZWN0ZWRIdG1sKTtcbiAgICBjb25zdCBsaW5lcyA9IHByb3RlY3RlZEh0bWwuc3BsaXQoL1xcclxcbnxcXG58XFxyLyk7XG4gICAgY29uc3Qgc3RhcnQgPSBpZ25vcmVGaXJzdExpbmUgPyAxIDogMDtcblxuICAgIC8vIDEpINCU0LXRgtC10LrRgiDRiNCw0LPQsCDQuCDQvNC40L3QuNC80LDQu9GM0L3QvtCz0L4g0L7RgtGB0YLRg9C/0LBcbiAgICBjb25zdCB7IG1pbiwgc3RlcDogYXV0b1N0ZXAgfSA9IGRldGVjdEluZGVudFN0ZXAocHJvdGVjdGVkSHRtbCwgeyBpZ25vcmVGaXJzdExpbmUsIHRhYldpZHRoIH0pO1xuXG4gICAgLy8gMikgRGVkZW50OiDRg9Cx0LjRgNCw0LXQvCDQvtCx0YnQuNC5INC80LjQvdC40LzQsNC70YzQvdGL0Lkg0L7RgtGB0YLRg9C/XG4gICAgaWYgKG5vcm1hbGl6ZUluZGVudCAmJiBtaW4gPiAwKSB7XG4gICAgICAgIGZvciAobGV0IGkgPSBzdGFydDsgaSA8IGxpbmVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBjb25zdCBsbiA9IGxpbmVzW2ldO1xuICAgICAgICAgICAgaWYgKGxuLnRyaW0oKSA9PT0gJycpIGNvbnRpbnVlO1xuICAgICAgICAgICAgbGluZXNbaV0gPSBzdHJpcEluZGVudENvbHVtbnMobG4sIG1pbiwgdGFiV2lkdGgpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLy8gMykg0JrQstCw0L3RgtC40LfQsNGG0LjRjyDQuiDRgdC10YLQutC1IDJuLzRuINC/0L4g0LbQtdC70LDQvdC40Y5cbiAgICBsZXQgc3RlcCA9IGFsaWduU3RlcCA9PT0gJ2F1dG8nID8gYXV0b1N0ZXAgOiBhbGlnblN0ZXA7XG4gICAgaWYgKHF1YW50aXplICE9PSAnbm9uZScgJiYgc3RlcCA+IDEpIHtcbiAgICAgICAgZm9yIChsZXQgaSA9IHN0YXJ0OyBpIDwgbGluZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGNvbnN0IGxuID0gbGluZXNbaV07XG4gICAgICAgICAgICBpZiAobG4udHJpbSgpID09PSAnJykgY29udGludWU7XG4gICAgICAgICAgICBsaW5lc1tpXSA9IGFkanVzdEluZGVudFRvR3JpZChsbiwgc3RlcCwgcXVhbnRpemUsIHRhYldpZHRoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vIDQpINCh0LrQu9C10LjQstCw0LXQvCDQuCDRg9Cx0LjRgNCw0LXQvCDQvNC10LbRgtC10LPQvtCy0YvQtSDQv9GA0L7QsdC10LvRiy/Qv9C10YDQtdCy0L7QtNGLINGB0YLRgNC+0LpcbiAgICBsZXQgd29ya2luZyA9IGxpbmVzLmpvaW4oZW9sKTtcblxuICAgIC8vIDUpIC4uLmRlZGVudC/QutCy0LDQvdGC0LjQt9Cw0YbQuNGPXG4gICAgd29ya2luZyA9IG5vcm1hbGl6ZVN0YXJ0VGFnV2hpdGVzcGFjZSh3b3JraW5nLCB7IHNjb3BlOiAndm9pZC1vbmx5JyB9KTtcblxuICAgIC8vIDYpINGD0LHRgNCw0YLRjCDQvNC10LbRgtC10LPQvtCy0YvQtSDQv9GA0L7QsdC10LvRi1xuICAgIHdvcmtpbmcgPSBjb2xsYXBzZUludGVyVGFnV2hpdGVzcGFjZVNtYXJ0KHdvcmtpbmcpO1xuXG4gICAgLy8gNykg0JLQvtC30LLRgNCw0YnQsNC10Lwg0LfQsNGJ0LjRidGR0L3QvdGL0LUg0LHQu9C+0LrQuFxuICAgIGNvbnN0IGNsZWFuZWQgPSB3b3JraW5nLnJlcGxhY2UoL1xcdTAwMDAoXFxkKylcXHUwMDAwL2csIChfLCBpKSA9PiBwbGFjZWhvbGRlcnNbK2ldKTtcbiAgICByZXR1cm4gY2xlYW5lZD8udHJpbT8uKCk7XG59XG5cbi8vXG5leHBvcnQgZnVuY3Rpb24gY2hlY2tJbnNpZGVUYWdCbG9jayhjb250ZXh0UGFydHM6IHN0cmluZ1tdLCAuLi5zdHI6IHN0cmluZ1tdKSB7XG4gICAgY29uc3QgY3VycmVudCA9IHN0cj8uWzBdID8/IFwiXCI7XG4gICAgY29uc3QgaWR4ID0gY29udGV4dFBhcnRzLmluZGV4T2YoY3VycmVudCk7XG4gICAgLy8gRmFsbGJhY2sgc2ltcGxlIGhldXJpc3RpYyBpZiBpbmRleCBub3QgZm91bmRcbiAgICBpZiAoaWR4IDwgMCkge1xuICAgICAgICBjb25zdCB0YWlsID0gKHN0cj8uam9pbj8uKFwiXCIpID8/IFwiXCIpO1xuICAgICAgICByZXR1cm4gLzwoW0EtWmEtelxcLyE/XSlbXFx3XFxXXSokLy50ZXN0KHRhaWwpICYmICEvPltcXHdcXFddKiQvLnRlc3QodGFpbCk7XG4gICAgfVxuXG4gICAgLy8gU2NhbiBhbGwgc3RhdGljIHBhcnRzIHVwIHRvIGFuZCBpbmNsdWRpbmcgdGhlIGN1cnJlbnQgcGFydFxuICAgIGNvbnN0IHByZWZpeCA9IGNvbnRleHRQYXJ0cy5zbGljZSgwLCBpZHggKyAxKS5qb2luKFwiXCIpO1xuICAgIGxldCBpblRhZyA9IGZhbHNlLCBpblNpbmdsZSA9IGZhbHNlLCBpbkRvdWJsZSA9IGZhbHNlO1xuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwcmVmaXgubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgY29uc3QgY2ggPSBwcmVmaXhbaV07XG4gICAgICAgIGNvbnN0IG5leHQgPSBwcmVmaXhbaSArIDFdID8/ICcnO1xuXG4gICAgICAgIGlmICghaW5UYWcpIHtcbiAgICAgICAgICAgIGlmIChjaCA9PT0gJzwnKSB7XG4gICAgICAgICAgICAgICAgLy8gVHJlYXQgYXMgYSB0YWcgb25seSBpZiBmb2xsb3dlZCBieSBhIGxpa2VseSBvcGVuZXI6IGxldHRlciwgJy8nLCAnIScsIG9yICc/J1xuICAgICAgICAgICAgICAgIGlmICgvW0EtWmEtelxcLyE/XS8udGVzdChuZXh0KSkge1xuICAgICAgICAgICAgICAgICAgICBpblRhZyA9IHRydWU7IGluU2luZ2xlID0gZmFsc2U7IGluRG91YmxlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIWluU2luZ2xlICYmICFpbkRvdWJsZSkge1xuICAgICAgICAgICAgaWYgKGNoID09PSAnXCInKSB7IGluRG91YmxlID0gdHJ1ZTsgY29udGludWU7IH1cbiAgICAgICAgICAgIGlmIChjaCA9PT0gXCInXCIpIHsgaW5TaW5nbGUgPSB0cnVlOyBjb250aW51ZTsgfVxuICAgICAgICAgICAgaWYgKGNoID09PSAnPicpIHsgaW5UYWcgPSBmYWxzZTsgY29udGludWU7IH1cbiAgICAgICAgfSBlbHNlIGlmIChpbkRvdWJsZSkge1xuICAgICAgICAgICAgaWYgKGNoID09PSAnXCInKSB7IGluRG91YmxlID0gZmFsc2U7IGNvbnRpbnVlOyB9XG4gICAgICAgIH0gZWxzZSBpZiAoaW5TaW5nbGUpIHtcbiAgICAgICAgICAgIGlmIChjaCA9PT0gXCInXCIpIHsgaW5TaW5nbGUgPSBmYWxzZTsgY29udGludWU7IH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBpblRhZztcbn1cbiJdfQ==