import { E, elementPointerMap } from "fest/lure";
import { DOMMixin } from "fest/dom";
//
export class UIGridBox extends DOMMixin {
    constructor(name) { super(name); }
    // @ts-ignore
    connect(ws) {
        const self = ws?.deref?.();
        E(self, { classList: new Set(["ui-gridlayout"]) });
        //
        const size = [self.clientWidth, self.clientHeight];
        const resizeObserver = new ResizeObserver((entries) => {
            for (const entry of entries) {
                if (entry?.contentBoxSize) {
                    const contentBoxSize = entry?.contentBoxSize?.[0];
                    size[0] = (contentBoxSize?.inlineSize || size[0] || 0);
                    size[1] = (contentBoxSize?.blockSize || size[1] || 0);
                }
            }
        });
        //
        Object.defineProperty(self, "size", { get: () => size });
        //
        resizeObserver.observe(self, { box: "content-box" });
        elementPointerMap.set(self, {
            pointerMap: new Map(),
            pointerCache: new Map()
        });
    }
}
//
new UIGridBox("ui-gridbox");
export default UIGridBox;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiR3JpZEJveC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIkdyaWRCb3gudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLENBQUMsRUFBRSxpQkFBaUIsRUFBRSxNQUFNLFdBQVcsQ0FBQztBQUNqRCxPQUFPLEVBQUUsUUFBUSxFQUFFLE1BQU0sVUFBVSxDQUFDO0FBRXBDLEVBQUU7QUFDRixNQUFNLE9BQU8sU0FBVSxTQUFRLFFBQVE7SUFDbkMsWUFBWSxJQUFLLElBQUksS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUVuQyxhQUFhO0lBQ2IsT0FBTyxDQUFDLEVBQUU7UUFDTixNQUFNLElBQUksR0FBUSxFQUFFLEVBQUUsS0FBSyxFQUFFLEVBQUUsQ0FBQztRQUNoQyxDQUFDLENBQUMsSUFBSSxFQUFFLEVBQUMsU0FBUyxFQUFFLElBQUksR0FBRyxDQUFDLENBQUMsZUFBZSxDQUFDLENBQUMsRUFBQyxDQUFDLENBQUM7UUFFakQsRUFBRTtRQUNGLE1BQU0sSUFBSSxHQUFHLENBQUMsSUFBSSxDQUFDLFdBQVcsRUFBRSxJQUFJLENBQUMsWUFBWSxDQUFDLENBQUM7UUFDbkQsTUFBTSxjQUFjLEdBQUcsSUFBSSxjQUFjLENBQUMsQ0FBQyxPQUFPLEVBQUUsRUFBRTtZQUNsRCxLQUFLLE1BQU0sS0FBSyxJQUFJLE9BQU8sRUFBRSxDQUFDO2dCQUMxQixJQUFJLEtBQUssRUFBRSxjQUFjLEVBQUUsQ0FBQztvQkFDeEIsTUFBTSxjQUFjLEdBQUcsS0FBSyxFQUFFLGNBQWMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDO29CQUNsRCxJQUFJLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxjQUFjLEVBQUUsVUFBVSxJQUFJLElBQUksQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQztvQkFDdkQsSUFBSSxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsY0FBYyxFQUFFLFNBQVMsSUFBSSxJQUFJLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7Z0JBQzFELENBQUM7WUFDTCxDQUFDO1FBQ0wsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFO1FBQ0YsTUFBTSxDQUFDLGNBQWMsQ0FBQyxJQUFJLEVBQUUsTUFBTSxFQUFFLEVBQUUsR0FBRyxFQUFFLEdBQUcsRUFBRSxDQUFDLElBQUksRUFBRSxDQUFDLENBQUM7UUFFekQsRUFBRTtRQUNGLGNBQWMsQ0FBQyxPQUFPLENBQUMsSUFBSSxFQUFFLEVBQUMsR0FBRyxFQUFFLGFBQWEsRUFBQyxDQUFDLENBQUM7UUFDbkQsaUJBQWlCLENBQUMsR0FBRyxDQUFDLElBQUksRUFBRTtZQUN4QixVQUFVLEVBQUUsSUFBSSxHQUFHLEVBQWU7WUFDbEMsWUFBWSxFQUFFLElBQUksR0FBRyxFQUFlO1NBQ3ZDLENBQUMsQ0FBQztJQUNQLENBQUM7Q0FDSjtBQUVELEVBQUU7QUFDRixJQUFJLFNBQVMsQ0FBQyxZQUFZLENBQUMsQ0FBQztBQUM1QixlQUFlLFNBQVMsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEUsIGVsZW1lbnRQb2ludGVyTWFwIH0gZnJvbSBcImZlc3QvbHVyZVwiO1xuaW1wb3J0IHsgRE9NTWl4aW4gfSBmcm9tIFwiZmVzdC9kb21cIjtcblxuLy9cbmV4cG9ydCBjbGFzcyBVSUdyaWRCb3ggZXh0ZW5kcyBET01NaXhpbiB7XG4gICAgY29uc3RydWN0b3IobmFtZT8pIHsgc3VwZXIobmFtZSk7IH1cblxuICAgIC8vIEB0cy1pZ25vcmVcbiAgICBjb25uZWN0KHdzKSB7XG4gICAgICAgIGNvbnN0IHNlbGY6IGFueSA9IHdzPy5kZXJlZj8uKCk7XG4gICAgICAgIEUoc2VsZiwge2NsYXNzTGlzdDogbmV3IFNldChbXCJ1aS1ncmlkbGF5b3V0XCJdKX0pO1xuXG4gICAgICAgIC8vXG4gICAgICAgIGNvbnN0IHNpemUgPSBbc2VsZi5jbGllbnRXaWR0aCwgc2VsZi5jbGllbnRIZWlnaHRdO1xuICAgICAgICBjb25zdCByZXNpemVPYnNlcnZlciA9IG5ldyBSZXNpemVPYnNlcnZlcigoZW50cmllcykgPT4ge1xuICAgICAgICAgICAgZm9yIChjb25zdCBlbnRyeSBvZiBlbnRyaWVzKSB7XG4gICAgICAgICAgICAgICAgaWYgKGVudHJ5Py5jb250ZW50Qm94U2l6ZSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBjb250ZW50Qm94U2l6ZSA9IGVudHJ5Py5jb250ZW50Qm94U2l6ZT8uWzBdO1xuICAgICAgICAgICAgICAgICAgICBzaXplWzBdID0gKGNvbnRlbnRCb3hTaXplPy5pbmxpbmVTaXplIHx8IHNpemVbMF0gfHwgMCk7XG4gICAgICAgICAgICAgICAgICAgIHNpemVbMV0gPSAoY29udGVudEJveFNpemU/LmJsb2NrU2l6ZSB8fCBzaXplWzFdIHx8IDApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy9cbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHNlbGYsIFwic2l6ZVwiLCB7IGdldDogKCkgPT4gc2l6ZSB9KTtcblxuICAgICAgICAvL1xuICAgICAgICByZXNpemVPYnNlcnZlci5vYnNlcnZlKHNlbGYsIHtib3g6IFwiY29udGVudC1ib3hcIn0pO1xuICAgICAgICBlbGVtZW50UG9pbnRlck1hcC5zZXQoc2VsZiwge1xuICAgICAgICAgICAgcG9pbnRlck1hcDogbmV3IE1hcDxudW1iZXIsIGFueT4oKSxcbiAgICAgICAgICAgIHBvaW50ZXJDYWNoZTogbmV3IE1hcDxudW1iZXIsIGFueT4oKVxuICAgICAgICB9KTtcbiAgICB9XG59XG5cbi8vXG5uZXcgVUlHcmlkQm94KFwidWktZ3JpZGJveFwiKTtcbmV4cG9ydCBkZWZhdWx0IFVJR3JpZEJveDtcbiJdfQ==