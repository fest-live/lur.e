import { numberRef } from "fest/object";
export class Vector2D {
    _x;
    _y;
    constructor(x = 0, y = 0) {
        this._x = typeof x === 'number' ? numberRef(x) : x;
        this._y = typeof y === 'number' ? numberRef(y) : y;
    }
    get x() { return this._x; }
    set x(value) {
        if (typeof value === 'number') {
            this._x.value = value;
        }
        else {
            this._x = value;
        }
    }
    get y() { return this._y; }
    set y(value) {
        if (typeof value === 'number') {
            this._y.value = value;
        }
        else {
            this._y = value;
        }
    }
    // Array-like access for compatibility
    get 0() { return this._x; }
    get 1() { return this._y; }
    // Convert to plain array for operations
    toArray() {
        return [this._x, this._y];
    }
    // Clone the vector
    clone() {
        return new Vector2D(this._x.value, this._y.value);
    }
    // Set values
    set(x, y) {
        this._x.value = x;
        this._y.value = y;
        return this;
    }
    // Copy from another vector
    copy(v) {
        this._x.value = v.x.value;
        this._y.value = v.y.value;
        return this;
    }
    // Vector operations
    add(v) {
        return new Vector2D(this._x.value + v.x.value, this._y.value + v.y.value);
    }
    subtract(v) {
        return new Vector2D(this._x.value - v.x.value, this._y.value - v.y.value);
    }
    multiply(scalar) {
        return new Vector2D(this._x.value * scalar, this._y.value * scalar);
    }
    divide(scalar) {
        if (scalar === 0)
            throw new Error("Division by zero");
        return new Vector2D(this._x.value / scalar, this._y.value / scalar);
    }
    // Dot product
    dot(v) {
        return this._x.value * v.x.value + this._y.value * v.y.value;
    }
    // Cross product (returns scalar in 2D)
    cross(v) {
        return this._x.value * v.y.value - this._y.value * v.x.value;
    }
    // Magnitude (length)
    magnitude() {
        return Math.sqrt(this._x.value * this._x.value + this._y.value * this._y.value);
    }
    // Squared magnitude (faster than magnitude for comparisons)
    magnitudeSquared() {
        return this._x.value * this._x.value + this._y.value * this._y.value;
    }
    // Distance to another vector
    distanceTo(v) {
        const dx = this._x.value - v.x.value;
        const dy = this._y.value - v.y.value;
        return Math.sqrt(dx * dx + dy * dy);
    }
    // Squared distance (faster for comparisons)
    distanceToSquared(v) {
        const dx = this._x.value - v.x.value;
        const dy = this._y.value - v.y.value;
        return dx * dx + dy * dy;
    }
    // Normalize (make unit length)
    normalize() {
        const mag = this.magnitude();
        if (mag === 0)
            return new Vector2D(0, 0);
        return new Vector2D(this._x.value / mag, this._y.value / mag);
    }
    // Check if vectors are equal
    equals(v, tolerance = 1e-6) {
        return Math.abs(this._x.value - v.x.value) < tolerance &&
            Math.abs(this._y.value - v.y.value) < tolerance;
    }
    // Linear interpolation
    lerp(v, t) {
        const clampedT = Math.max(0, Math.min(1, t));
        return new Vector2D(this._x.value + (v.x.value - this._x.value) * clampedT, this._y.value + (v.y.value - this._y.value) * clampedT);
    }
    // Angle with another vector (in radians)
    angleTo(v) {
        const dot = this.dot(v);
        const det = this.cross(v);
        return Math.atan2(det, dot);
    }
    // Rotate vector by angle (in radians)
    rotate(angle) {
        const cos = Math.cos(angle);
        const sin = Math.sin(angle);
        return new Vector2D(this._x.value * cos - this._y.value * sin, this._x.value * sin + this._y.value * cos);
    }
    // Project onto another vector
    projectOnto(v) {
        const scalar = this.dot(v) / v.magnitudeSquared();
        return v.multiply(scalar);
    }
    // Reflect across a normal vector
    reflect(normal) {
        const normalizedNormal = normal.normalize();
        const dotProduct = this.dot(normalizedNormal);
        return this.subtract(normalizedNormal.multiply(2 * dotProduct));
    }
    // Clamp vector components
    clamp(min, max) {
        return new Vector2D(Math.max(min.x.value, Math.min(max.x.value, this._x.value)), Math.max(min.y.value, Math.min(max.y.value, this._y.value)));
    }
    // Get the minimum component
    min() {
        return Math.min(this._x.value, this._y.value);
    }
    // Get the maximum component
    max() {
        return Math.max(this._x.value, this._y.value);
    }
    // Static utility methods
    static zero() {
        return new Vector2D(0, 0);
    }
    static one() {
        return new Vector2D(1, 1);
    }
    static unitX() {
        return new Vector2D(1, 0);
    }
    static unitY() {
        return new Vector2D(0, 1);
    }
    // Create vector from angle (in radians)
    static fromAngle(angle, length = 1) {
        return new Vector2D(Math.cos(angle) * length, Math.sin(angle) * length);
    }
    // Create vector from polar coordinates
    static fromPolar(angle, radius) {
        return Vector2D.fromAngle(angle, radius);
    }
}
export const vector2Ref = (x = 0, y = 0) => {
    return new Vector2D(x, y);
};
export class Matrix2D {
    _elements;
    constructor(a = 1, b = 0, c = 0, d = 1) {
        this._elements = [
            typeof a === 'number' ? numberRef(a) : a,
            typeof b === 'number' ? numberRef(b) : b,
            typeof c === 'number' ? numberRef(c) : c,
            typeof d === 'number' ? numberRef(d) : d
        ];
    }
    get elements() { return this._elements; }
    // Matrix elements access
    get m00() { return this._elements[0]; }
    get m01() { return this._elements[1]; }
    get m10() { return this._elements[2]; }
    get m11() { return this._elements[3]; }
    set m00(value) {
        if (typeof value === 'number')
            this._elements[0].value = value;
        else
            this._elements[0] = value;
    }
    set m01(value) {
        if (typeof value === 'number')
            this._elements[1].value = value;
        else
            this._elements[1] = value;
    }
    set m10(value) {
        if (typeof value === 'number')
            this._elements[2].value = value;
        else
            this._elements[2] = value;
    }
    set m11(value) {
        if (typeof value === 'number')
            this._elements[3].value = value;
        else
            this._elements[3] = value;
    }
    // Array-like access for compatibility
    get 0() { return this._elements[0]; }
    get 1() { return this._elements[1]; }
    get 2() { return this._elements[2]; }
    get 3() { return this._elements[3]; }
    // Convert to plain array for operations
    toArray() {
        return [...this._elements];
    }
    // Clone the matrix
    clone() {
        return new Matrix2D(this._elements[0].value, this._elements[1].value, this._elements[2].value, this._elements[3].value);
    }
    // Set values
    set(a, b, c, d) {
        this._elements[0].value = a;
        this._elements[1].value = b;
        this._elements[2].value = c;
        this._elements[3].value = d;
        return this;
    }
    // Identity matrix
    identity() {
        return this.set(1, 0, 0, 1);
    }
    // Copy from another matrix
    copy(m) {
        this._elements[0].value = m.elements[0].value;
        this._elements[1].value = m.elements[1].value;
        this._elements[2].value = m.elements[2].value;
        this._elements[3].value = m.elements[3].value;
        return this;
    }
    // Matrix operations
    multiply(m) {
        const a = this._elements[0].value, b = this._elements[1].value;
        const c = this._elements[2].value, d = this._elements[3].value;
        const e = m.elements[0].value, f = m.elements[1].value;
        const g = m.elements[2].value, h = m.elements[3].value;
        return new Matrix2D(a * e + b * g, a * f + b * h, c * e + d * g, c * f + d * h);
    }
    multiplyScalar(s) {
        return new Matrix2D(this._elements[0].value * s, this._elements[1].value * s, this._elements[2].value * s, this._elements[3].value * s);
    }
    // Transform a vector
    transformVector(v) {
        const x = this._elements[0].value * v.x.value + this._elements[1].value * v.y.value;
        const y = this._elements[2].value * v.x.value + this._elements[3].value * v.y.value;
        return new Vector2D(x, y);
    }
    // Determinant
    determinant() {
        return this._elements[0].value * this._elements[3].value -
            this._elements[1].value * this._elements[2].value;
    }
    // Inverse matrix
    inverse() {
        const det = this.determinant();
        if (det === 0)
            return null; // Not invertible
        const invDet = 1 / det;
        return new Matrix2D(this._elements[3].value * invDet, -this._elements[1].value * invDet, -this._elements[2].value * invDet, this._elements[0].value * invDet);
    }
    // Transpose
    transpose() {
        return new Matrix2D(this._elements[0].value, this._elements[2].value, this._elements[1].value, this._elements[3].value);
    }
    // Check if matrices are equal
    equals(m, tolerance = 1e-6) {
        for (let i = 0; i < 4; i++) {
            if (Math.abs(this._elements[i].value - m.elements[i].value) > tolerance) {
                return false;
            }
        }
        return true;
    }
    // Create rotation matrix
    static rotation(angle) {
        const cos = Math.cos(angle);
        const sin = Math.sin(angle);
        return new Matrix2D(cos, -sin, sin, cos);
    }
    // Create scale matrix
    static scale(sx, sy = sx) {
        return new Matrix2D(sx, 0, 0, sy);
    }
    // Create shear matrix
    static shear(sx, sy) {
        return new Matrix2D(1, sx, sy, 1);
    }
}
export const matrix2x2Ref = (a = 1, b = 0, c = 0, d = 1) => {
    return new Matrix2D(a, b, c, d);
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiUG9pbnQyRC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIlBvaW50MkQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLFNBQVMsRUFBVyxNQUFNLGFBQWEsQ0FBQztBQUVqRCxNQUFNLE9BQU8sUUFBUTtJQUNULEVBQUUsQ0FBK0I7SUFDakMsRUFBRSxDQUErQjtJQUV6QyxZQUFZLElBQTJDLENBQUMsRUFBRSxJQUEyQyxDQUFDO1FBQ2xHLElBQUksQ0FBQyxFQUFFLEdBQUcsT0FBTyxDQUFDLEtBQUssUUFBUSxDQUFDLENBQUMsQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUNuRCxJQUFJLENBQUMsRUFBRSxHQUFHLE9BQU8sQ0FBQyxLQUFLLFFBQVEsQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFDdkQsQ0FBQztJQUVELElBQUksQ0FBQyxLQUFLLE9BQU8sSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7SUFDM0IsSUFBSSxDQUFDLENBQUMsS0FBNEM7UUFDOUMsSUFBSSxPQUFPLEtBQUssS0FBSyxRQUFRLEVBQUUsQ0FBQztZQUM1QixJQUFJLENBQUMsRUFBRSxDQUFDLEtBQUssR0FBRyxLQUFLLENBQUM7UUFDMUIsQ0FBQzthQUFNLENBQUM7WUFDSixJQUFJLENBQUMsRUFBRSxHQUFHLEtBQUssQ0FBQztRQUNwQixDQUFDO0lBQ0wsQ0FBQztJQUVELElBQUksQ0FBQyxLQUFLLE9BQU8sSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7SUFDM0IsSUFBSSxDQUFDLENBQUMsS0FBNEM7UUFDOUMsSUFBSSxPQUFPLEtBQUssS0FBSyxRQUFRLEVBQUUsQ0FBQztZQUM1QixJQUFJLENBQUMsRUFBRSxDQUFDLEtBQUssR0FBRyxLQUFLLENBQUM7UUFDMUIsQ0FBQzthQUFNLENBQUM7WUFDSixJQUFJLENB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QUUsQ0FBQztnQkFDdEUsT0FBTyxLQUFLLENBQUM7WUFDakIsQ0FBQztRQUNMLENBQUM7UUFDRCxPQUFPLElBQUksQ0FBQztJQUNoQixDQUFDO0lBRUQseUJBQXlCO0lBQ3pCLE1BQU0sQ0FBQyxRQUFRLENBQUMsS0FBYTtRQUN6QixNQUFNLEdBQUcsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQzVCLE1BQU0sR0FBRyxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDNUIsT0FBTyxJQUFJLFFBQVEsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUcsQ0FBQyxDQUFDO0lBQzdDLENBQUM7SUFFRCxzQkFBc0I7SUFDdEIsTUFBTSxDQUFDLEtBQUssQ0FBQyxFQUFVLEVBQUUsS0FBYSxFQUFFO1FBQ3BDLE9BQU8sSUFBSSxRQUFRLENBQUMsRUFBRSxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUM7SUFDdEMsQ0FBQztJQUVELHNCQUFzQjtJQUN0QixNQUFNLENBQUMsS0FBSyxDQUFDLEVBQVUsRUFBRSxFQUFVO1FBQy9CLE9BQU8sSUFBSSxRQUFRLENBQUMsQ0FBQyxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsQ0FBQyxDQUFDLENBQUM7SUFDdEMsQ0FBQztDQUNKO0FBRUQsTUFBTSxDQUFDLE1BQU0sWUFBWSxHQUFHLENBQ3hCLElBQTJDLENBQUMsRUFBRSxJQUEyQyxDQUFDLEVBQzFGLElBQTJDLENBQUMsRUFBRSxJQUEyQyxDQUFDLEVBQzVGLEVBQUU7SUFDQSxPQUFPLElBQUksUUFBUSxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDO0FBQ3BDLENBQUMsQ0FBQSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IG51bWJlclJlZiwgb2JzZXJ2ZSB9IGZyb20gXCJmZXN0L29iamVjdFwiO1xuXG5leHBvcnQgY2xhc3MgVmVjdG9yMkQge1xuICAgIHByaXZhdGUgX3g6IFJldHVyblR5cGU8dHlwZW9mIG51bWJlclJlZj47XG4gICAgcHJpdmF0ZSBfeTogUmV0dXJuVHlwZTx0eXBlb2YgbnVtYmVyUmVmPjtcblxuICAgIGNvbnN0cnVjdG9yKHg6IG51bWJlciB8IFJldHVyblR5cGU8dHlwZW9mIG51bWJlclJlZj4gPSAwLCB5OiBudW1iZXIgfCBSZXR1cm5UeXBlPHR5cGVvZiBudW1iZXJSZWY+ID0gMCkge1xuICAgICAgICB0aGlzLl94ID0gdHlwZW9mIHggPT09ICdudW1iZXInID8gbnVtYmVyUmVmKHgpIDogeDtcbiAgICAgICAgdGhpcy5feSA9IHR5cGVvZiB5ID09PSAnbnVtYmVyJyA/IG51bWJlclJlZih5KSA6IHk7XG4gICAgfVxuXG4gICAgZ2V0IHgoKSB7IHJldHVybiB0aGlzLl94OyB9XG4gICAgc2V0IHgodmFsdWU6IG51bWJlciB8IFJldHVyblR5cGU8dHlwZW9mIG51bWJlclJlZj4pIHtcbiAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ251bWJlcicpIHtcbiAgICAgICAgICAgIHRoaXMuX3gudmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuX3ggPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGdldCB5KCkgeyByZXR1cm4gdGhpcy5feTsgfVxuICAgIHNldCB5KHZhbHVlOiBudW1iZXIgfCBSZXR1cm5UeXBlPHR5cGVvZiBudW1iZXJSZWY+KSB7XG4gICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdudW1iZXInKSB7XG4gICAgICAgICAgICB0aGlzLl95LnZhbHVlID0gdmFsdWU7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl95ID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBBcnJheS1saWtlIGFjY2VzcyBmb3IgY29tcGF0aWJpbGl0eVxuICAgIGdldCAwKCkgeyByZXR1cm4gdGhpcy5feDsgfVxuICAgIGdldCAxKCkgeyByZXR1cm4gdGhpcy5feTsgfVxuXG4gICAgLy8gQ29udmVydCB0byBwbGFpbiBhcnJheSBmb3Igb3BlcmF0aW9uc1xuICAgIHRvQXJyYXkoKSB7XG4gICAgICAgIHJldHVybiBbdGhpcy5feCwgdGhpcy5feV07XG4gICAgfVxuXG4gICAgLy8gQ2xvbmUgdGhlIHZlY3RvclxuICAgIGNsb25lKCkge1xuICAgICAgICByZXR1cm4gbmV3IFZlY3RvcjJEKHRoaXMuX3gudmFsdWUsIHRoaXMuX3kudmFsdWUpO1xuICAgIH1cblxuICAgIC8vIFNldCB2YWx1ZXNcbiAgICBzZXQoeDogbnVtYmVyLCB5OiBudW1iZXIpIHtcbiAgICAgICAgdGhpcy5feC52YWx1ZSA9IHg7XG4gICAgICAgIHRoaXMuX3kudmFsdWUgPSB5O1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgICAvLyBDb3B5IGZyb20gYW5vdGhlciB2ZWN0b3JcbiAgICBjb3B5KHY6IFZlY3RvcjJEKSB7XG4gICAgICAgIHRoaXMuX3gudmFsdWUgPSB2LngudmFsdWU7XG4gICAgICAgIHRoaXMuX3kudmFsdWUgPSB2LnkudmFsdWU7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxuICAgIC8vIFZlY3RvciBvcGVyYXRpb25zXG4gICAgYWRkKHY6IFZlY3RvcjJEKTogVmVjdG9yMkQge1xuICAgICAgICByZXR1cm4gbmV3IFZlY3RvcjJEKHRoaXMuX3gudmFsdWUgKyB2LngudmFsdWUsIHRoaXMuX3kudmFsdWUgKyB2LnkudmFsdWUpO1xuICAgIH1cblxuICAgIHN1YnRyYWN0KHY6IFZlY3RvcjJEKTogVmVjdG9yMkQge1xuICAgICAgICByZXR1cm4gbmV3IFZlY3RvcjJEKHRoaXMuX3gudmFsdWUgLSB2LngudmFsdWUsIHRoaXMuX3kudmFsdWUgLSB2LnkudmFsdWUpO1xuICAgIH1cblxuICAgIG11bHRpcGx5KHNjYWxhcjogbnVtYmVyKTogVmVjdG9yMkQge1xuICAgICAgICByZXR1cm4gbmV3IFZlY3RvcjJEKHRoaXMuX3gudmFsdWUgKiBzY2FsYXIsIHRoaXMuX3kudmFsdWUgKiBzY2FsYXIpO1xuICAgIH1cblxuICAgIGRpdmlkZShzY2FsYXI6IG51bWJlcik6IFZlY3RvcjJEIHtcbiAgICAgICAgaWYgKHNjYWxhciA9PT0gMCkgdGhyb3cgbmV3IEVycm9yKFwiRGl2aXNpb24gYnkgemVyb1wiKTtcbiAgICAgICAgcmV0dXJuIG5ldyBWZWN0b3IyRCh0aGlzLl94LnZhbHVlIC8gc2NhbGFyLCB0aGlzLl95LnZhbHVlIC8gc2NhbGFyKTtcbiAgICB9XG5cbiAgICAvLyBEb3QgcHJvZHVjdFxuICAgIGRvdCh2OiBWZWN0b3IyRCk6IG51bWJlciB7XG4gICAgICAgIHJldHVybiB0aGlzLl94LnZhbHVlICogdi54LnZhbHVlICsgdGhpcy5feS52YWx1ZSAqIHYueS52YWx1ZTtcbiAgICB9XG5cbiAgICAvLyBDcm9zcyBwcm9kdWN0IChyZXR1cm5zIHNjYWxhciBpbiAyRClcbiAgICBjcm9zcyh2OiBWZWN0b3IyRCk6IG51bWJlciB7XG4gICAgICAgIHJldHVybiB0aGlzLl94LnZhbHVlICogdi55LnZhbHVlIC0gdGhpcy5feS52YWx1ZSAqIHYueC52YWx1ZTtcbiAgICB9XG5cbiAgICAvLyBNYWduaXR1ZGUgKGxlbmd0aClcbiAgICBtYWduaXR1ZGUoKTogbnVtYmVyIHtcbiAgICAgICAgcmV0dXJuIE1hdGguc3FydCh0aGlzLl94LnZhbHVlICogdGhpcy5feC52YWx1ZSArIHRoaXMuX3kudmFsdWUgKiB0aGlzLl95LnZhbHVlKTtcbiAgICB9XG5cbiAgICAvLyBTcXVhcmVkIG1hZ25pdHVkZSAoZmFzdGVyIHRoYW4gbWFnbml0dWRlIGZvciBjb21wYXJpc29ucylcbiAgICBtYWduaXR1ZGVTcXVhcmVkKCk6IG51bWJlciB7XG4gICAgICAgIHJldHVybiB0aGlzLl94LnZhbHVlICogdGhpcy5feC52YWx1ZSArIHRoaXMuX3kudmFsdWUgKiB0aGlzLl95LnZhbHVlO1xuICAgIH1cblxuICAgIC8vIERpc3RhbmNlIHRvIGFub3RoZXIgdmVjdG9yXG4gICAgZGlzdGFuY2VUbyh2OiBWZWN0b3IyRCk6IG51bWJlciB7XG4gICAgICAgIGNvbnN0IGR4ID0gdGhpcy5feC52YWx1ZSAtIHYueC52YWx1ZTtcbiAgICAgICAgY29uc3QgZHkgPSB0aGlzLl95LnZhbHVlIC0gdi55LnZhbHVlO1xuICAgICAgICByZXR1cm4gTWF0aC5zcXJ0KGR4ICogZHggKyBkeSAqIGR5KTtcbiAgICB9XG5cbiAgICAvLyBTcXVhcmVkIGRpc3RhbmNlIChmYXN0ZXIgZm9yIGNvbXBhcmlzb25zKVxuICAgIGRpc3RhbmNlVG9TcXVhcmVkKHY6IFZlY3RvcjJEKTogbnVtYmVyIHtcbiAgICAgICAgY29uc3QgZHggPSB0aGlzLl94LnZhbHVlIC0gdi54LnZhbHVlO1xuICAgICAgICBjb25zdCBkeSA9IHRoaXMuX3kudmFsdWUgLSB2LnkudmFsdWU7XG4gICAgICAgIHJldHVybiBkeCAqIGR4ICsgZHkgKiBkeTtcbiAgICB9XG5cbiAgICAvLyBOb3JtYWxpemUgKG1ha2UgdW5pdCBsZW5ndGgpXG4gICAgbm9ybWFsaXplKCk6IFZlY3RvcjJEIHtcbiAgICAgICAgY29uc3QgbWFnID0gdGhpcy5tYWduaXR1ZGUoKTtcbiAgICAgICAgaWYgKG1hZyA9PT0gMCkgcmV0dXJuIG5ldyBWZWN0b3IyRCgwLCAwKTtcbiAgICAgICAgcmV0dXJuIG5ldyBWZWN0b3IyRCh0aGlzLl94LnZhbHVlIC8gbWFnLCB0aGlzLl95LnZhbHVlIC8gbWFnKTtcbiAgICB9XG5cbiAgICAvLyBDaGVjayBpZiB2ZWN0b3JzIGFyZSBlcXVhbFxuICAgIGVxdWFscyh2OiBWZWN0b3IyRCwgdG9sZXJhbmNlOiBudW1iZXIgPSAxZS02KTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiBNYXRoLmFicyh0aGlzLl94LnZhbHVlIC0gdi54LnZhbHVlKSA8IHRvbGVyYW5jZSAmJlxuICAgICAgICAgICAgICAgTWF0aC5hYnModGhpcy5feS52YWx1ZSAtIHYueS52YWx1ZSkgPCB0b2xlcmFuY2U7XG4gICAgfVxuXG4gICAgLy8gTGluZWFyIGludGVycG9sYXRpb25cbiAgICBsZXJwKHY6IFZlY3RvcjJELCB0OiBudW1iZXIpOiBWZWN0b3IyRCB7XG4gICAgICAgIGNvbnN0IGNsYW1wZWRUID0gTWF0aC5tYXgoMCwgTWF0aC5taW4oMSwgdCkpO1xuICAgICAgICByZXR1cm4gbmV3IFZlY3RvcjJEKFxuICAgICAgICAgICAgdGhpcy5feC52YWx1ZSArICh2LngudmFsdWUgLSB0aGlzLl94LnZhbHVlKSAqIGNsYW1wZWRULFxuICAgICAgICAgICAgdGhpcy5feS52YWx1ZSArICh2LnkudmFsdWUgLSB0aGlzLl95LnZhbHVlKSAqIGNsYW1wZWRUXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgLy8gQW5nbGUgd2l0aCBhbm90aGVyIHZlY3RvciAoaW4gcmFkaWFucylcbiAgICBhbmdsZVRvKHY6IFZlY3RvcjJEKTogbnVtYmVyIHtcbiAgICAgICAgY29uc3QgZG90ID0gdGhpcy5kb3Qodik7XG4gICAgICAgIGNvbnN0IGRldCA9IHRoaXMuY3Jvc3Modik7XG4gICAgICAgIHJldHVybiBNYXRoLmF0YW4yKGRldCwgZG90KTtcbiAgICB9XG5cbiAgICAvLyBSb3RhdGUgdmVjdG9yIGJ5IGFuZ2xlIChpbiByYWRpYW5zKVxuICAgIHJvdGF0ZShhbmdsZTogbnVtYmVyKTogVmVjdG9yMkQge1xuICAgICAgICBjb25zdCBjb3MgPSBNYXRoLmNvcyhhbmdsZSk7XG4gICAgICAgIGNvbnN0IHNpbiA9IE1hdGguc2luKGFuZ2xlKTtcbiAgICAgICAgcmV0dXJuIG5ldyBWZWN0b3IyRChcbiAgICAgICAgICAgIHRoaXMuX3gudmFsdWUgKiBjb3MgLSB0aGlzLl95LnZhbHVlICogc2luLFxuICAgICAgICAgICAgdGhpcy5feC52YWx1ZSAqIHNpbiArIHRoaXMuX3kudmFsdWUgKiBjb3NcbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICAvLyBQcm9qZWN0IG9udG8gYW5vdGhlciB2ZWN0b3JcbiAgICBwcm9qZWN0T250byh2OiBWZWN0b3IyRCk6IFZlY3RvcjJEIHtcbiAgICAgICAgY29uc3Qgc2NhbGFyID0gdGhpcy5kb3QodikgLyB2Lm1hZ25pdHVkZVNxdWFyZWQoKTtcbiAgICAgICAgcmV0dXJuIHYubXVsdGlwbHkoc2NhbGFyKTtcbiAgICB9XG5cbiAgICAvLyBSZWZsZWN0IGFjcm9zcyBhIG5vcm1hbCB2ZWN0b3JcbiAgICByZWZsZWN0KG5vcm1hbDogVmVjdG9yMkQpOiBWZWN0b3IyRCB7XG4gICAgICAgIGNvbnN0IG5vcm1hbGl6ZWROb3JtYWwgPSBub3JtYWwubm9ybWFsaXplKCk7XG4gICAgICAgIGNvbnN0IGRvdFByb2R1Y3QgPSB0aGlzLmRvdChub3JtYWxpemVkTm9ybWFsKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuc3VidHJhY3Qobm9ybWFsaXplZE5vcm1hbC5tdWx0aXBseSgyICogZG90UHJvZHVjdCkpO1xuICAgIH1cblxuICAgIC8vIENsYW1wIHZlY3RvciBjb21wb25lbnRzXG4gICAgY2xhbXAobWluOiBWZWN0b3IyRCwgbWF4OiBWZWN0b3IyRCk6IFZlY3RvcjJEIHtcbiAgICAgICAgcmV0dXJuIG5ldyBWZWN0b3IyRChcbiAgICAgICAgICAgIE1hdGgubWF4KG1pbi54LnZhbHVlLCBNYXRoLm1pbihtYXgueC52YWx1ZSwgdGhpcy5feC52YWx1ZSkpLFxuICAgICAgICAgICAgTWF0aC5tYXgobWluLnkudmFsdWUsIE1hdGgubWluKG1heC55LnZhbHVlLCB0aGlzLl95LnZhbHVlKSlcbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICAvLyBHZXQgdGhlIG1pbmltdW0gY29tcG9uZW50XG4gICAgbWluKCk6IG51bWJlciB7XG4gICAgICAgIHJldHVybiBNYXRoLm1pbih0aGlzLl94LnZhbHVlLCB0aGlzLl95LnZhbHVlKTtcbiAgICB9XG5cbiAgICAvLyBHZXQgdGhlIG1heGltdW0gY29tcG9uZW50XG4gICAgbWF4KCk6IG51bWJlciB7XG4gICAgICAgIHJldHVybiBNYXRoLm1heCh0aGlzLl94LnZhbHVlLCB0aGlzLl95LnZhbHVlKTtcbiAgICB9XG5cbiAgICAvLyBTdGF0aWMgdXRpbGl0eSBtZXRob2RzXG4gICAgc3RhdGljIHplcm8oKTogVmVjdG9yMkQge1xuICAgICAgICByZXR1cm4gbmV3IFZlY3RvcjJEKDAsIDApO1xuICAgIH1cblxuICAgIHN0YXRpYyBvbmUoKTogVmVjdG9yMkQge1xuICAgICAgICByZXR1cm4gbmV3IFZlY3RvcjJEKDEsIDEpO1xuICAgIH1cblxuICAgIHN0YXRpYyB1bml0WCgpOiBWZWN0b3IyRCB7XG4gICAgICAgIHJldHVybiBuZXcgVmVjdG9yMkQoMSwgMCk7XG4gICAgfVxuXG4gICAgc3RhdGljIHVuaXRZKCk6IFZlY3RvcjJEIHtcbiAgICAgICAgcmV0dXJuIG5ldyBWZWN0b3IyRCgwLCAxKTtcbiAgICB9XG5cbiAgICAvLyBDcmVhdGUgdmVjdG9yIGZyb20gYW5nbGUgKGluIHJhZGlhbnMpXG4gICAgc3RhdGljIGZyb21BbmdsZShhbmdsZTogbnVtYmVyLCBsZW5ndGg6IG51bWJlciA9IDEpOiBWZWN0b3IyRCB7XG4gICAgICAgIHJldHVybiBuZXcgVmVjdG9yMkQoXG4gICAgICAgICAgICBNYXRoLmNvcyhhbmdsZSkgKiBsZW5ndGgsXG4gICAgICAgICAgICBNYXRoLnNpbihhbmdsZSkgKiBsZW5ndGhcbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICAvLyBDcmVhdGUgdmVjdG9yIGZyb20gcG9sYXIgY29vcmRpbmF0ZXNcbiAgICBzdGF0aWMgZnJvbVBvbGFyKGFuZ2xlOiBudW1iZXIsIHJhZGl1czogbnVtYmVyKTogVmVjdG9yMkQge1xuICAgICAgICByZXR1cm4gVmVjdG9yMkQuZnJvbUFuZ2xlKGFuZ2xlLCByYWRpdXMpO1xuICAgIH1cbn1cblxuZXhwb3J0IGNvbnN0IHZlY3RvcjJSZWYgPSAoeDogbnVtYmVyIHwgUmV0dXJuVHlwZTx0eXBlb2YgbnVtYmVyUmVmPiA9IDAsIHk6IG51bWJlciB8IFJldHVyblR5cGU8dHlwZW9mIG51bWJlclJlZj4gPSAwKSA9PiB7XG4gICAgcmV0dXJuIG5ldyBWZWN0b3IyRCh4LCB5KTtcbn1cblxuZXhwb3J0IGNsYXNzIE1hdHJpeDJEIHtcbiAgICBwcml2YXRlIF9lbGVtZW50czogUmV0dXJuVHlwZTx0eXBlb2YgbnVtYmVyUmVmPltdO1xuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIGE6IG51bWJlciB8IFJldHVyblR5cGU8dHlwZW9mIG51bWJlclJlZj4gPSAxLCBiOiBudW1iZXIgfCBSZXR1cm5UeXBlPHR5cGVvZiBudW1iZXJSZWY+ID0gMCxcbiAgICAgICAgYzogbnVtYmVyIHwgUmV0dXJuVHlwZTx0eXBlb2YgbnVtYmVyUmVmPiA9IDAsIGQ6IG51bWJlciB8IFJldHVyblR5cGU8dHlwZW9mIG51bWJlclJlZj4gPSAxXG4gICAgKSB7XG4gICAgICAgIHRoaXMuX2VsZW1lbnRzID0gW1xuICAgICAgICAgICAgdHlwZW9mIGEgPT09ICdudW1iZXInID8gbnVtYmVyUmVmKGEpIDogYSxcbiAgICAgICAgICAgIHR5cGVvZiBiID09PSAnbnVtYmVyJyA/IG51bWJlclJlZihiKSA6IGIsXG4gICAgICAgICAgICB0eXBlb2YgYyA9PT0gJ251bWJlcicgPyBudW1iZXJSZWYoYykgOiBjLFxuICAgICAgICAgICAgdHlwZW9mIGQgPT09ICdudW1iZXInID8gbnVtYmVyUmVmKGQpIDogZFxuICAgICAgICBdO1xuICAgIH1cblxuICAgIGdldCBlbGVtZW50cygpIHsgcmV0dXJuIHRoaXMuX2VsZW1lbnRzOyB9XG5cbiAgICAvLyBNYXRyaXggZWxlbWVudHMgYWNjZXNzXG4gICAgZ2V0IG0wMCgpIHsgcmV0dXJuIHRoaXMuX2VsZW1lbnRzWzBdOyB9XG4gICAgZ2V0IG0wMSgpIHsgcmV0dXJuIHRoaXMuX2VsZW1lbnRzWzFdOyB9XG4gICAgZ2V0IG0xMCgpIHsgcmV0dXJuIHRoaXMuX2VsZW1lbnRzWzJdOyB9XG4gICAgZ2V0IG0xMSgpIHsgcmV0dXJuIHRoaXMuX2VsZW1lbnRzWzNdOyB9XG5cbiAgICBzZXQgbTAwKHZhbHVlOiBudW1iZXIgfCBSZXR1cm5UeXBlPHR5cGVvZiBudW1iZXJSZWY+KSB7XG4gICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdudW1iZXInKSB0aGlzLl9lbGVtZW50c1swXS52YWx1ZSA9IHZhbHVlO1xuICAgICAgICBlbHNlIHRoaXMuX2VsZW1lbnRzWzBdID0gdmFsdWU7XG4gICAgfVxuICAgIHNldCBtMDEodmFsdWU6IG51bWJlciB8IFJldHVyblR5cGU8dHlwZW9mIG51bWJlclJlZj4pIHtcbiAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ251bWJlcicpIHRoaXMuX2VsZW1lbnRzWzFdLnZhbHVlID0gdmFsdWU7XG4gICAgICAgIGVsc2UgdGhpcy5fZWxlbWVudHNbMV0gPSB2YWx1ZTtcbiAgICB9XG4gICAgc2V0IG0xMCh2YWx1ZTogbnVtYmVyIHwgUmV0dXJuVHlwZTx0eXBlb2YgbnVtYmVyUmVmPikge1xuICAgICAgICBpZiAodHlwZW9mIHZhbHVlID09PSAnbnVtYmVyJykgdGhpcy5fZWxlbWVudHNbMl0udmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgZWxzZSB0aGlzLl9lbGVtZW50c1syXSA9IHZhbHVlO1xuICAgIH1cbiAgICBzZXQgbTExKHZhbHVlOiBudW1iZXIgfCBSZXR1cm5UeXBlPHR5cGVvZiBudW1iZXJSZWY+KSB7XG4gICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdudW1iZXInKSB0aGlzLl9lbGVtZW50c1szXS52YWx1ZSA9IHZhbHVlO1xuICAgICAgICBlbHNlIHRoaXMuX2VsZW1lbnRzWzNdID0gdmFsdWU7XG4gICAgfVxuXG4gICAgLy8gQXJyYXktbGlrZSBhY2Nlc3MgZm9yIGNvbXBhdGliaWxpdHlcbiAgICBnZXQgMCgpIHsgcmV0dXJuIHRoaXMuX2VsZW1lbnRzWzBdOyB9XG4gICAgZ2V0IDEoKSB7IHJldHVybiB0aGlzLl9lbGVtZW50c1sxXTsgfVxuICAgIGdldCAyKCkgeyByZXR1cm4gdGhpcy5fZWxlbWVudHNbMl07IH1cbiAgICBnZXQgMygpIHsgcmV0dXJuIHRoaXMuX2VsZW1lbnRzWzNdOyB9XG5cbiAgICAvLyBDb252ZXJ0IHRvIHBsYWluIGFycmF5IGZvciBvcGVyYXRpb25zXG4gICAgdG9BcnJheSgpIHtcbiAgICAgICAgcmV0dXJuIFsuLi50aGlzLl9lbGVtZW50c107XG4gICAgfVxuXG4gICAgLy8gQ2xvbmUgdGhlIG1hdHJpeFxuICAgIGNsb25lKCkge1xuICAgICAgICByZXR1cm4gbmV3IE1hdHJpeDJEKFxuICAgICAgICAgICAgdGhpcy5fZWxlbWVudHNbMF0udmFsdWUsIHRoaXMuX2VsZW1lbnRzWzFdLnZhbHVlLFxuICAgICAgICAgICAgdGhpcy5fZWxlbWVudHNbMl0udmFsdWUsIHRoaXMuX2VsZW1lbnRzWzNdLnZhbHVlXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgLy8gU2V0IHZhbHVlc1xuICAgIHNldChhOiBudW1iZXIsIGI6IG51bWJlciwgYzogbnVtYmVyLCBkOiBudW1iZXIpIHtcbiAgICAgICAgdGhpcy5fZWxlbWVudHNbMF0udmFsdWUgPSBhO1xuICAgICAgICB0aGlzLl9lbGVtZW50c1sxXS52YWx1ZSA9IGI7XG4gICAgICAgIHRoaXMuX2VsZW1lbnRzWzJdLnZhbHVlID0gYztcbiAgICAgICAgdGhpcy5fZWxlbWVudHNbM10udmFsdWUgPSBkO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgICAvLyBJZGVudGl0eSBtYXRyaXhcbiAgICBpZGVudGl0eSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2V0KDEsIDAsIDAsIDEpO1xuICAgIH1cblxuICAgIC8vIENvcHkgZnJvbSBhbm90aGVyIG1hdHJpeFxuICAgIGNvcHkobTogTWF0cml4MkQpIHtcbiAgICAgICAgdGhpcy5fZWxlbWVudHNbMF0udmFsdWUgPSBtLmVsZW1lbnRzWzBdLnZhbHVlO1xuICAgICAgICB0aGlzLl9lbGVtZW50c1sxXS52YWx1ZSA9IG0uZWxlbWVudHNbMV0udmFsdWU7XG4gICAgICAgIHRoaXMuX2VsZW1lbnRzWzJdLnZhbHVlID0gbS5lbGVtZW50c1syXS52YWx1ZTtcbiAgICAgICAgdGhpcy5fZWxlbWVudHNbM10udmFsdWUgPSBtLmVsZW1lbnRzWzNdLnZhbHVlO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgICAvLyBNYXRyaXggb3BlcmF0aW9uc1xuICAgIG11bHRpcGx5KG06IE1hdHJpeDJEKTogTWF0cml4MkQge1xuICAgICAgICBjb25zdCBhID0gdGhpcy5fZWxlbWVudHNbMF0udmFsdWUsIGIgPSB0aGlzLl9lbGVtZW50c1sxXS52YWx1ZTtcbiAgICAgICAgY29uc3QgYyA9IHRoaXMuX2VsZW1lbnRzWzJdLnZhbHVlLCBkID0gdGhpcy5fZWxlbWVudHNbM10udmFsdWU7XG4gICAgICAgIGNvbnN0IGUgPSBtLmVsZW1lbnRzWzBdLnZhbHVlLCBmID0gbS5lbGVtZW50c1sxXS52YWx1ZTtcbiAgICAgICAgY29uc3QgZyA9IG0uZWxlbWVudHNbMl0udmFsdWUsIGggPSBtLmVsZW1lbnRzWzNdLnZhbHVlO1xuXG4gICAgICAgIHJldHVybiBuZXcgTWF0cml4MkQoXG4gICAgICAgICAgICBhICogZSArIGIgKiBnLCBhICogZiArIGIgKiBoLFxuICAgICAgICAgICAgYyAqIGUgKyBkICogZywgYyAqIGYgKyBkICogaFxuICAgICAgICApO1xuICAgIH1cblxuICAgIG11bHRpcGx5U2NhbGFyKHM6IG51bWJlcik6IE1hdHJpeDJEIHtcbiAgICAgICAgcmV0dXJuIG5ldyBNYXRyaXgyRChcbiAgICAgICAgICAgIHRoaXMuX2VsZW1lbnRzWzBdLnZhbHVlICogcywgdGhpcy5fZWxlbWVudHNbMV0udmFsdWUgKiBzLFxuICAgICAgICAgICAgdGhpcy5fZWxlbWVudHNbMl0udmFsdWUgKiBzLCB0aGlzLl9lbGVtZW50c1szXS52YWx1ZSAqIHNcbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICAvLyBUcmFuc2Zvcm0gYSB2ZWN0b3JcbiAgICB0cmFuc2Zvcm1WZWN0b3IodjogVmVjdG9yMkQpOiBWZWN0b3IyRCB7XG4gICAgICAgIGNvbnN0IHggPSB0aGlzLl9lbGVtZW50c1swXS52YWx1ZSAqIHYueC52YWx1ZSArIHRoaXMuX2VsZW1lbnRzWzFdLnZhbHVlICogdi55LnZhbHVlO1xuICAgICAgICBjb25zdCB5ID0gdGhpcy5fZWxlbWVudHNbMl0udmFsdWUgKiB2LngudmFsdWUgKyB0aGlzLl9lbGVtZW50c1szXS52YWx1ZSAqIHYueS52YWx1ZTtcbiAgICAgICAgcmV0dXJuIG5ldyBWZWN0b3IyRCh4LCB5KTtcbiAgICB9XG5cbiAgICAvLyBEZXRlcm1pbmFudFxuICAgIGRldGVybWluYW50KCk6IG51bWJlciB7XG4gICAgICAgIHJldHVybiB0aGlzLl9lbGVtZW50c1swXS52YWx1ZSAqIHRoaXMuX2VsZW1lbnRzWzNdLnZhbHVlIC1cbiAgICAgICAgICAgICAgIHRoaXMuX2VsZW1lbnRzWzFdLnZhbHVlICogdGhpcy5fZWxlbWVudHNbMl0udmFsdWU7XG4gICAgfVxuXG4gICAgLy8gSW52ZXJzZSBtYXRyaXhcbiAgICBpbnZlcnNlKCk6IE1hdHJpeDJEIHwgbnVsbCB7XG4gICAgICAgIGNvbnN0IGRldCA9IHRoaXMuZGV0ZXJtaW5hbnQoKTtcbiAgICAgICAgaWYgKGRldCA9PT0gMCkgcmV0dXJuIG51bGw7IC8vIE5vdCBpbnZlcnRpYmxlXG5cbiAgICAgICAgY29uc3QgaW52RGV0ID0gMSAvIGRldDtcbiAgICAgICAgcmV0dXJuIG5ldyBNYXRyaXgyRChcbiAgICAgICAgICAgIHRoaXMuX2VsZW1lbnRzWzNdLnZhbHVlICogaW52RGV0LCAtdGhpcy5fZWxlbWVudHNbMV0udmFsdWUgKiBpbnZEZXQsXG4gICAgICAgICAgICAtdGhpcy5fZWxlbWVudHNbMl0udmFsdWUgKiBpbnZEZXQsIHRoaXMuX2VsZW1lbnRzWzBdLnZhbHVlICogaW52RGV0XG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgLy8gVHJhbnNwb3NlXG4gICAgdHJhbnNwb3NlKCk6IE1hdHJpeDJEIHtcbiAgICAgICAgcmV0dXJuIG5ldyBNYXRyaXgyRChcbiAgICAgICAgICAgIHRoaXMuX2VsZW1lbnRzWzBdLnZhbHVlLCB0aGlzLl9lbGVtZW50c1syXS52YWx1ZSxcbiAgICAgICAgICAgIHRoaXMuX2VsZW1lbnRzWzFdLnZhbHVlLCB0aGlzLl9lbGVtZW50c1szXS52YWx1ZVxuICAgICAgICApO1xuICAgIH1cblxuICAgIC8vIENoZWNrIGlmIG1hdHJpY2VzIGFyZSBlcXVhbFxuICAgIGVxdWFscyhtOiBNYXRyaXgyRCwgdG9sZXJhbmNlOiBudW1iZXIgPSAxZS02KTogYm9vbGVhbiB7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgNDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAoTWF0aC5hYnModGhpcy5fZWxlbWVudHNbaV0udmFsdWUgLSBtLmVsZW1lbnRzW2ldLnZhbHVlKSA+IHRvbGVyYW5jZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICAvLyBDcmVhdGUgcm90YXRpb24gbWF0cml4XG4gICAgc3RhdGljIHJvdGF0aW9uKGFuZ2xlOiBudW1iZXIpOiBNYXRyaXgyRCB7XG4gICAgICAgIGNvbnN0IGNvcyA9IE1hdGguY29zKGFuZ2xlKTtcbiAgICAgICAgY29uc3Qgc2luID0gTWF0aC5zaW4oYW5nbGUpO1xuICAgICAgICByZXR1cm4gbmV3IE1hdHJpeDJEKGNvcywgLXNpbiwgc2luLCBjb3MpO1xuICAgIH1cblxuICAgIC8vIENyZWF0ZSBzY2FsZSBtYXRyaXhcbiAgICBzdGF0aWMgc2NhbGUoc3g6IG51bWJlciwgc3k6IG51bWJlciA9IHN4KTogTWF0cml4MkQge1xuICAgICAgICByZXR1cm4gbmV3IE1hdHJpeDJEKHN4LCAwLCAwLCBzeSk7XG4gICAgfVxuXG4gICAgLy8gQ3JlYXRlIHNoZWFyIG1hdHJpeFxuICAgIHN0YXRpYyBzaGVhcihzeDogbnVtYmVyLCBzeTogbnVtYmVyKTogTWF0cml4MkQge1xuICAgICAgICByZXR1cm4gbmV3IE1hdHJpeDJEKDEsIHN4LCBzeSwgMSk7XG4gICAgfVxufVxuXG5leHBvcnQgY29uc3QgbWF0cml4MngyUmVmID0gKFxuICAgIGE6IG51bWJlciB8IFJldHVyblR5cGU8dHlwZW9mIG51bWJlclJlZj4gPSAxLCBiOiBudW1iZXIgfCBSZXR1cm5UeXBlPHR5cGVvZiBudW1iZXJSZWY+ID0gMCxcbiAgICBjOiBudW1iZXIgfCBSZXR1cm5UeXBlPHR5cGVvZiBudW1iZXJSZWY+ID0gMCwgZDogbnVtYmVyIHwgUmV0dXJuVHlwZTx0eXBlb2YgbnVtYmVyUmVmPiA9IDFcbikgPT4ge1xuICAgIHJldHVybiBuZXcgTWF0cml4MkQoYSwgYiwgYywgZCk7XG59XG4iXX0=